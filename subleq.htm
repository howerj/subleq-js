<!DOCTYPE html>
<html lang="en">
<head>
	<title>SUBLEQ eForth</title>
	<meta charset="UTF-8">
	<!-- icon from https://www.favicon.cc/?action=icon&file_id=927824, looks free -->
	<link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQflAwQSNCzUzyUcAAAAZElEQVQoz31RSxYAIQiCebOdW8xBuzlt+mGWbQQVyogZWnJiC11QRjij8gFQIzWOdWtM9aIA4LnaeKn8HZZ3srRZBi268DHTsUGrBYN049w1QUx87cL+KfE1iQIR7cZy9+UJACqZqS+d7tw82QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wMy0wNFQxODo1Mjo0NCswMDowMK54rJEAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDMtMDRUMTg6NTI6NDQrMDA6MDDfJRQtAAAAAElFTkSuQmCC">
	<style type="text/css">
		body{margin:40px auto;max-width:50%;line-height:1.6;font-size:18px;color:#444;padding:0 10px;}
		pre { white-space: pre-wrap; }
		.tab { overflow: hidden; border: 1px solid #ccc; background-color: #f1f1f1; }
		.tab button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; }
		.tab button:hover { background-color: #ddd; }
		.tab button.active { background-color: #ccc; }
		.tabcontent { display: none; padding: 6px 12px; border: 1px solid #ccc; border-top: none; }
		.blink { animation: blinker 0.6s linear infinite; color: #333333; font-size: 24px; font-weight: bold; }
		@keyframes blinker { 50% { opacity: 0; } }
		label.buttonHack input[type="file"] { position:absolute; top: -1000px; }
		.buttonHack { border: 2px solid #AAA; border-radius: 4px; padding: 2px 5px; margin: 2px; background: #DDD; display: inline-block; }
		.buttonHack :hover { background: #CCC; }
		.buttonHack :active { background: #CCF; }
	</style>
</head>
<body>
	<div class="tab">
		<button class="tablinks" onclick="openTab(event, 'subleq')">subleq</button>
		<button class="tablinks" onclick="openTab(event, 'image')">image</button>
		<button class="tablinks" onclick="openTab(event, 'settings')">settings</button>
		<button class="tablinks" onclick="openTab(event, 'help')">help</button>
		<button class="tablinks" onclick="openTab(event, 'about')">about</button>
	</div>
	<div id="subleq" class="tabcontent"> </div>
	<div id="help"   class="tabcontent">
		<p>This system contains a <a href=" https://en.wikipedia.org/wiki/One-instruction_set_computer">SUBLEQ</a>
		virtual machine, a 16-bit version, that will automatically boot an eForth image, which is a variant of
		<a href="https://en.wikipedia.org/wiki/Forth_(programming_language)">Forth</a>, a stack
		based programming language suitable for constrained system.  What makes this system special
		is that SUBLEQ is a Turing complete <i>single instruction</i> machine, the instruction
		is short for "Subtract and Branch If Less Than Or Equal To Zero", it does a little more
		than that, but it means we do not have access to multiplication, division, addition,
		or even the basic bitwise operators such as AND or XOR in the base instruction set,
		nor calls, returns, or indirect load/stores. They all have to be synthesized.</p>
		<p>Each SUBLEQ instruction consists of three arguments; 'a', 'b', 'c'. 'a' and 'b'
		are addresses from which arguments are loaded from, the contents of the address
		of 'a' are subtracted from the contents at 'b' and stored back into 'b', if the
		result is less than or equal to zero, then 'c' is directly jumped to, otherwise
		the program counter is incremented by three, moving to the next instruction.</p>
		<p>There are two minor special cases, one for input, and one for output, if 'a'
		is the address -1, then a byte is loaded from input and stored into the location
		pointed to by 'b', if 'b' is -1 then a byte is loaded from the location pointed
		to by 'a' and stored to output. Input is taken from the keyboard and output is
		the terminal screen in the case of this emulator.</p>
		<p>The following program, written in C, is capable of executing the same images
		that are used within this program, which you can click on to download:</p>
		<pre style="color:blue;" onclick="downloadTextAsFile('subleq.c', unesc(event.currentTarget.innerHTML))">
	#include &lt;stdio.h&gt;
	int main(int x,char**v){FILE*f=fopen(v[1],"r");short p=0,m[1&lt;&lt;16],*i=m;
	while(fscanf(f,"%hd",i++)&gt;0);for(;p&gt;=0;){int a=m[p++],b=m[p++],c=m[p++];
	a&lt;0?m[b]=getchar():b&lt;0?putchar(m[a]):(m[b]-=m[a])&lt;=0?p=c:0;}}
		</pre>
		<p> A Forth tutorial is beyond this help section. However, here are a few commands
		you can type into the system to get started: </p>
		<pre> words </pre>
		<p>This will print out a list of all of the built in functions defined in Forth.</p>
		<pre> 2 2 + . cr </pre>
		<p>Add two numbers together, both 2, and print the result, 4 along with a newline.</p>
		<pre> : ahoy cr ." Hello, World!" ; </pre>
		<p>Define a new word (functions are called "words" in Forth) named "ahoy", which when
		called like so:</p>
		<pre> ahoy </pre>
		<p>Will print the standard greeting. If the Forth interpreter is happy, "ok" will be
		printed out after entering each line. Be careful, white-space matters a lot in Forth.</p>
		<p> You can hit ESC to clear the screen and restart the system. </p>
		<p> The original SUBLEQ system, and images, came from another project of mine
		available at <a href="https://github.com/howerj/subleq">https://github.com/howerj/subleq</a>.
		You can find and load newer images there, specifically 
		<a href="https://raw.githubusercontent.com/howerj/subleq/master/subleq.dec">here</a>, which
		you should be able to load from "image" tab. The system is self-hosting, it can be used
		to generate new eForth images if fed the right source code, although that is best done
		from the command line and not on this web-site.
		</p>
		<p>
		The following file contains a program that can be loaded that prints "Hi", 
		<a href="javascript:downloadTextAsFile('hi.dec', atob('OQotMQozCjEwCi0xCjYKMAowCi0xCjcyCjEwNQowCg=='))">hi.dec</a>.
		</p>
		<p> Happy hacking! </p>
	</div>
	<div id="about" class="tabcontent">
		<table style="width:100%">
			<tr><th>Author</th><td>Richard James Howe</td></tr>
			<tr><th>Project</th><td>eForth running on SUBLEQ</td></tr>
			<tr><th>Email</th><td><a href="mailto:howe.r.j.89@gmail.com?subject=eForth SUBLEQ">howe.r.j.89@gmail.com</a></td></tr>
			<tr><th>Repo</th><td><a href="https://github.com/howerj/subleq-js">https://github.com/howerj/subleq-js</a></td></tr>
			<tr><th>License</th><td><a href="https://raw.githubusercontent.com/howerj/subleq/master/LICENSE">The Unlicense</a> / Public Domain</td></tr>
		</table>
	</div>
	<div id="settings" class="tabcontent">
		<input type="checkbox" id="highlight" name="highlight" onchange="saveCookies()" checked>
		<label for="highlight">highlight </label><br>
		<input type="checkbox" id="scroll" name="scroll" onchange="saveCookies()"  checked>
		<label for="scroll">scroll </label><br>
		<input type="checkbox" id="optimizeImage" name="optimizeImage" onchange="saveCookies()" checked>
		<label for="optimizeImage">remove trailing zeros on save </label><br>
		<label for="base">base </label>
		<input type="number" id="base" name="base" min="2" max="36" onchange="saveCookies()" value=16>
	</div>
	<div id="image" class="tabcontent">
		<div>
			<label class="buttonHack"> <button hidden onclick="saveImage()">save</button> <span>save</span></label>
			<label for="fname">file</label>
			<input type="text" id="fname" name="fname" value="subleq.dec">
			<label for="cells">cells</label>
			<input type="text" id="cells" name="cells" value="8192">
		</div>
		<label class="buttonHack">
			<input type="file" id="input" oninput="loadImage()">
			<span>load</span>
		</label>
		<hr>
		<pre id="dump"></pre>
	</div>
	<canvas id="keydown"></canvas>
	<script type="text/javascript">
		const init = ".( EFORTH LOADED - USED:) here u. cr\n";
		var display = "", input = init, cursor = '<b class="blink">_</b>';
		var loaded = false, focused = false, running = true, reloadOnExit = true;
		var redrawTimeout;
		var pc = 0, cycles = 0, total = 0, m = new Uint16Array(65536);
		var eForth = [
			0,0,49,11,4159,-32768,128,-2,-1,1,2,16,0,0,0,0,0,0,0,15902,
			32256,3840,-11257,0,0,0,0,0,0,0,0,64,15884,15846,14768,15182,
			7659,0,15884,0,0,47,30255,32,0,32384,32384,32512,32512,48,48,
			52,47,0,55,0,48,58,0,0,61,46,46,64,45,0,67,0,46,70,0,
			0,73,43,43,76,36,0,79,0,43,82,0,0,85,13,13,88,43,0,91,
			0,13,94,0,0,97,8,43,100,115,115,103,13,0,106,0,115,109,0,
			0,112,15,15,115,0,0,118,0,15,121,0,0,124,13,13,127,15,0,
			130,0,13,133,0,0,136,4,15,139,15,0,145,0,0,148,0,0,163,
			162,162,151,13,0,154,0,162,157,0,0,160,0,0,163,8,46,166,
			202,202,169,46,0,172,0,202,175,0,0,178,203,203,181,46,0,
			184,0,203,187,0,0,190,209,209,193,46,0,196,0,209,199,0,0,
			202,0,0,205,43,0,208,0,0,211,0,0,214,43,43,217,13,0,220,
			0,43,223,0,0,226,0,0,85,0,0,-1,0,0,85,9,44,238,0,0,85,
			8,44,244,0,0,85,12,12,250,44,12,253,44,44,256,12,0,259,
			0,44,262,0,0,265,9,44,268,0,0,85,286,286,274,44,0,277,0,
			286,280,0,0,283,44,44,286,0,0,289,0,44,292,0,0,295,0,0,
			85,313,313,301,48,0,304,0,313,307,0,0,310,13,13,313,0,0,
			316,0,13,319,0,0,322,358,358,325,44,0,328,0,358,331,0,0,
			334,359,359,337,44,0,340,0,359,343,0,0,346,365,365,349,44,
			0,352,0,365,355,0,0,358,0,0,361,13,0,364,0,0,367,0,0,370,
			8,48,373,388,388,376,48,0,379,0,388,382,0,0,385,44,44,388,
			0,0,391,0,44,394,0,0,397,8,48,400,0,0,85,44,-1,406,421,
			421,409,48,0,412,0,421,415,0,0,418,44,44,421,0,0,424,0,44,
			427,0,0,430,8,48,433,0,0,85,9,48,439,475,475,442,48,0,445,
			0,475,448,0,0,451,476,476,454,48,0,457,0,476,460,0,0,463,
			482,482,466,48,0,469,0,482,472,0,0,475,0,0,478,44,0,481,
			0,0,484,0,0,487,-1,44,490,0,0,85,9,48,496,532,532,499,48,
			0,502,0,532,505,0,0,508,533,533,511,48,0,514,0,533,517,0,
			0,520,539,539,523,48,0,526,0,539,529,0,0,532,0,0,535,44,
			0,538,0,0,541,0,0,544,559,559,547,43,0,550,0,559,553,0,0,
			556,44,44,559,0,0,562,0,44,565,0,0,568,8,43,571,0,0,85,9,
			48,577,613,613,580,48,0,583,0,613,586,0,0,589,614,614,592,
			48,0,595,0,614,598,0,0,601,620,620,604,48,0,607,0,620,610,
			0,0,613,0,0,616,44,0,619,0,0,622,0,0,625,640,640,628,43,
			0,631,0,640,634,0,0,637,44,44,640,0,0,643,0,44,646,0,0,
			649,8,43,652,20,0,655,0,44,658,0,0,661,20,0,664,0,44,667,
			0,0,670,0,0,85,13,13,676,44,0,679,0,13,682,0,0,685,700,
			700,688,48,0,691,0,700,694,0,0,697,44,44,700,0,0,703,0,44,
			706,0,0,709,745,745,712,48,0,715,0,745,718,0,0,721,746,746,
			724,48,0,727,0,746,730,0,0,733,752,752,736,48,0,739,0,752,
			742,0,0,745,0,0,748,13,0,751,0,0,754,0,0,757,0,0,85,9,
			48,763,799,799,766,48,0,769,0,799,772,0,0,775,800,800,778,
			48,0,781,0,800,784,0,0,787,806,806,790,48,0,793,0,806,796,
			0,0,799,0,0,802,44,0,805,0,0,808,0,0,811,0,0,85,829,829,
			817,48,0,820,0,829,823,0,0,826,13,13,829,0,0,832,0,13,835,
			0,0,838,9,48,841,877,877,844,48,0,847,0,877,850,0,0,853,
			878,878,856,48,0,859,0,878,862,0,0,865,884,884,868,48,0,
			871,0,884,874,0,0,877,0,0,880,44,0,883,0,0,886,0,0,889,
			44,44,892,13,0,895,0,44,898,0,0,901,0,0,85,919,919,907,
			48,0,910,0,919,913,0,0,916,44,44,919,0,0,922,0,44,925,0,
			0,928,8,48,931,0,0,85,8,46,937,973,973,940,46,0,943,0,973,
			946,0,0,949,974,974,952,46,0,955,0,974,958,0,0,961,980,980,
			964,46,0,967,0,980,970,0,0,973,0,0,976,44,0,979,0,0,982,
			0,0,985,1000,1000,988,48,0,991,0,1000,994,0,0,997,44,44,
			1000,0,0,1003,0,44,1006,0,0,1009,8,48,1012,0,0,85,9,48,
			1018,1054,1054,1021,48,0,1024,0,1054,1027,0,0,1030,1055,1055,
			1033,48,0,1036,0,1055,1039,0,0,1042,1061,1061,1045,48,0,1048,
			0,1061,1051,0,0,1054,0,0,1057,44,0,1060,0,0,1063,0,0,1066,
			1081,1081,1069,46,0,1072,0,1081,1075,0,0,1078,44,44,1081,0,0,
			1084,0,44,1087,0,0,1090,9,46,1093,0,0,85,1111,1111,1099,48,0,
			1102,0,1111,1105,0,0,1108,13,13,1111,0,0,1114,0,13,1117,0,0,
			1120,15,15,1123,13,0,1129,0,0,1135,0,0,1132,0,13,1150,44,0,
			1138,0,15,1141,0,0,1144,9,13,1147,0,0,1123,44,44,1153,15,0,
			1156,0,44,1159,0,0,1162,8,48,1165,0,0,85,1183,1183,1171,46,
			0,1174,0,1183,1177,0,0,1180,43,43,1183,0,0,1186,0,43,1189,
			0,0,1192,9,46,1195,0,0,85,1213,1213,1201,48,0,1204,0,1213,
			1207,0,0,1210,13,13,1213,0,0,1216,0,13,1219,0,0,1222,44,
			13,1225,44,44,1228,13,0,1231,0,44,1234,0,0,1237,8,48,1240,
			0,0,85,1258,1258,1246,48,0,1249,0,1258,1252,0,0,1255,13,13,
			1258,0,0,1261,0,13,1264,0,0,1267,13,0,1270,0,44,1273,0,0,
			1276,8,48,1279,0,0,85,9,48,1285,1321,1321,1288,48,0,1291,0,
			1321,1294,0,0,1297,1322,1322,1300,48,0,1303,0,1322,1306,0,0,
			1309,1328,1328,1312,48,0,1315,0,1328,1318,0,0,1321,0,0,1324,
			44,0,1327,0,0,1330,0,0,1333,1348,1348,1336,46,0,1339,0,1348,
			1342,0,0,1345,44,44,1348,0,0,1351,0,44,1354,0,0,1357,0,0,
			85,9,46,1363,0,0,85,9,48,1369,1405,1405,1372,48,0,1375,0,
			1405,1378,0,0,1381,1406,1406,1384,48,0,1387,0,1406,1390,0,0,
			1393,1412,1412,1396,48,0,1399,0,1412,1402,0,0,1405,0,0,1408,
			44,0,1411,0,0,1414,0,0,1417,44,44,1420,48,0,1423,0,44,1426,
			0,0,1429,8,44,1432,0,0,85,48,48,1438,44,0,1441,0,48,1444,
			0,0,1447,0,0,85,9,48,1453,1489,1489,1456,48,0,1459,0,1489,
			1462,0,0,1465,1490,1490,1468,48,0,1471,0,1490,1474,0,0,1477,
			1496,1496,1480,48,0,1483,0,1496,1486,0,0,1489,0,0,1492,44,
			0,1495,0,0,1498,0,0,1501,44,44,1504,46,0,1507,0,44,1510,
			0,0,1513,0,0,85,46,46,1519,44,0,1522,0,46,1525,0,0,1528,
			1543,1543,1531,48,0,1534,0,1543,1537,0,0,1540,44,44,1543,0,
			0,1546,0,44,1549,0,0,1552,8,48,1555,0,0,85,1573,1573,1561,
			46,0,1564,0,1573,1567,0,0,1570,13,13,1573,0,0,1576,0,13,
			1579,0,0,1582,13,0,1588,0,0,1594,0,0,1591,0,13,1684,9,13,
			1597,1633,1633,1600,46,0,1603,0,1633,1606,0,0,1609,1634,1634,
			1612,46,0,1615,0,1634,1618,0,0,1621,1640,1640,1624,46,0,1627,
			0,1640,1630,0,0,1633,0,0,1636,13,0,1639,0,0,1642,0,0,1645,
			1660,1660,1648,43,0,1651,0,1660,1654,0,0,1657,15,15,1660,0,
			0,1663,0,15,1666,0,0,1669,43,43,1672,15,0,1675,0,43,1678,0,
			0,1681,0,0,85,8,43,1687,9,46,1690,0,0,85,44,0,1696,0,44,
			1699,0,0,1702,44,0,1705,0,44,1708,0,0,1711,44,0,1714,0,44,
			1717,0,0,1720,44,0,1723,0,44,1726,0,0,1729,44,0,1732,0,44,
			1735,0,0,1738,44,0,1741,0,44,1744,0,0,1747,44,0,1750,0,44,
			1753,0,0,1756,44,0,1759,0,44,1762,0,0,1765,44,0,1768,0,44,
			1771,0,0,1774,44,0,1777,0,44,1780,0,0,1783,44,0,1786,0,44,
			1789,0,0,1792,44,0,1795,0,44,1798,0,0,1801,44,0,1804,0,44,
			1807,0,0,1810,44,0,1813,0,44,1816,0,0,1819,13,13,1822,44,0,
			1825,0,13,1828,0,0,1831,44,44,1834,0,0,1837,0,44,1840,0,0,
			1843,13,0,1849,0,0,1855,0,0,1852,0,13,1867,44,44,1858,8,0,
			1861,0,44,1864,0,0,1867,0,0,85,1885,1885,1873,43,0,1876,0,
			1885,1879,0,0,1882,43,43,1885,0,0,1888,0,43,1891,0,0,1894,
			0,0,85,13,13,1900,44,0,1903,0,13,1906,0,0,1909,15,15,1912,
			0,0,1915,0,15,1918,0,0,1921,13,0,1927,0,0,1933,0,0,1930,
			0,13,1945,15,15,1936,8,0,1939,0,15,1942,0,0,1945,9,13,1948,
			0,13,1963,15,15,1954,8,0,1957,0,15,1960,0,0,1963,1978,1978,
			1966,48,0,1969,0,1978,1972,0,0,1975,44,44,1978,0,0,1981,0,
			44,1984,0,0,1987,8,48,1990,15,0,1996,0,0,2002,0,0,1999,0,
			15,2008,8,43,2005,0,0,85,2023,2023,2011,43,0,2014,0,2023,2017,
			0,0,2020,13,13,2023,0,0,2026,0,13,2029,0,0,2032,43,43,2035,
			13,0,2038,0,43,2041,0,0,2044,0,0,85,13,13,2050,44,0,2053,
			0,13,2056,0,0,2059,44,44,2062,0,0,2065,0,44,2068,0,0,2071,
			0,13,2086,44,44,2077,8,0,2080,0,44,2083,0,0,2086,0,0,85,13,
			13,2092,44,0,2095,0,13,2098,0,0,2101,44,44,2104,8,0,2107,0,
			44,2110,0,0,2113,13,0,2119,0,0,2125,0,0,2122,0,13,2137,44,
			44,2128,0,0,2131,0,44,2134,0,0,2137,9,13,2140,0,13,2155,44,
			44,2146,0,0,2149,0,44,2152,0,0,2155,0,0,85,13,13,2161,44,0,
			2164,0,13,2167,0,0,2170,44,44,2173,0,0,2176,0,44,2179,0,0,
			2182,13,0,2188,0,0,2191,0,0,2203,44,44,2194,8,0,2197,0,44,
			2200,0,0,2203,8,13,2206,13,0,2212,0,0,2215,0,0,2227,44,44,
			2218,8,0,2221,0,44,2224,0,0,2227,0,0,85,2245,2245,2233,48,0,
			2236,0,2245,2239,0,0,2242,13,13,2245,0,0,2248,0,13,2251,0,
			0,2254,8,48,2257,44,13,2260,44,44,2263,0,0,2266,0,44,2269,
			0,0,2272,13,0,2278,0,0,2281,0,0,2293,44,44,2284,8,0,2287,
			0,44,2290,0,0,2293,0,0,85,2311,2311,2299,48,0,2302,0,2311,
			2305,0,0,2308,13,13,2311,0,0,2314,0,13,2317,0,0,2320,8,48,
			2323,44,13,2326,44,44,2329,0,0,2332,0,44,2335,0,0,2338,0,13,
			2353,44,44,2344,8,0,2347,0,44,2350,0,0,2353,0,0,85,44,0,
			2359,0,44,2362,0,0,2365,0,0,85,13,13,2371,11,0,2374,0,13,
			2377,0,0,2380,14,14,2383,9,13,2386,13,0,2392,0,0,2398,0,0,
			2395,0,13,2503,14,0,2401,0,14,2404,0,0,2407,18,18,2410,44,
			0,2413,0,18,2416,0,0,2419,16,16,2422,0,0,2425,0,16,2428,0,
			0,2431,18,0,2437,0,0,2440,0,0,2452,16,16,2443,8,0,2446,0,
			16,2449,0,0,2452,8,18,2455,18,0,2461,0,0,2464,0,0,2476,16,
			16,2467,8,0,2470,0,16,2473,0,0,2476,16,0,2482,0,0,2488,0,
			0,2485,0,16,2491,8,14,2491,44,0,2494,0,44,2497,0,0,2500,0,
			0,2383,44,44,2506,14,0,2509,0,44,2512,0,0,2515,0,0,85,13,
			13,2521,11,0,2524,0,13,2527,0,0,2530,44,13,2533,2548,2548,
			2536,48,0,2539,0,2548,2542,0,0,2545,44,44,2548,0,0,2551,0,
			44,2554,0,0,2557,8,48,2560,14,14,2563,13,0,2569,0,0,2575,
			0,0,2572,0,13,2683,14,0,2578,0,14,2581,0,0,2584,18,18,2587,
			44,0,2590,0,18,2593,0,0,2596,16,16,2599,0,0,2602,0,16,2605,
			0,0,2608,18,0,2614,0,0,2617,0,0,2629,16,16,2620,8,0,2623,
			0,16,2626,0,0,2629,8,18,2632,18,0,2638,0,0,2641,0,0,2653,
			16,16,2644,8,0,2647,0,16,2650,0,0,2653,16,0,2659,0,0,2665,
			0,0,2662,0,16,2668,8,14,2668,44,0,2671,0,44,2674,0,0,2677,
			9,13,2680,0,0,2563,44,44,2686,14,0,2689,0,44,2692,0,0,2695,
			0,0,85,13,13,2701,11,0,2704,0,13,2707,0,0,2710,14,14,2713,
			2728,2728,2716,48,0,2719,0,2728,2722,0,0,2725,15,15,2728,0,0,
			2731,0,15,2734,0,0,2737,8,48,2740,13,0,2746,0,0,2752,0,0,
			2749,0,13,2947,14,0,2755,0,14,2758,0,0,2761,18,18,2764,44,
			0,2767,0,18,2770,0,0,2773,16,16,2776,0,0,2779,0,16,2782,0,
			0,2785,18,0,2791,0,0,2794,0,0,2806,16,16,2797,8,0,2800,0,
			16,2803,0,0,2806,8,18,2809,18,0,2815,0,0,2818,0,0,2830,16,
			16,2821,8,0,2824,0,16,2827,0,0,2830,18,18,2833,15,0,2836,
			0,18,2839,0,0,2842,17,17,2845,0,0,2848,0,17,2851,0,0,2854,
			18,0,2860,0,0,2863,0,0,2875,17,17,2866,8,0,2869,0,17,2872,
			0,0,2875,8,18,2878,18,0,2884,0,0,2887,0,0,2899,17,17,2890,
			8,0,2893,0,17,2896,0,0,2899,16,0,2902,0,17,2905,0,0,2908,
			17,0,2914,0,0,2920,0,0,2917,0,17,2923,8,14,2923,15,0,2926,
			0,15,2929,0,0,2932,44,0,2935,0,44,2938,0,0,2941,9,13,2944,
			0,0,2740,44,44,2950,14,0,2953,0,44,2956,0,0,2959,0,0,85,
			13,13,2965,11,0,2968,0,13,2971,0,0,2974,14,14,2977,2992,
			2992,2980,48,0,2983,0,2992,2986,0,0,2989,15,15,2992,0,0,
			2995,0,15,2998,0,0,3001,8,48,3004,13,0,3010,0,0,3016,0,0,
			3013,0,13,3244,14,0,3019,0,14,3022,0,0,3025,18,18,3028,44,
			0,3031,0,18,3034,0,0,3037,16,16,3040,0,0,3043,0,16,3046,0,
			0,3049,18,0,3055,0,0,3058,0,0,3070,16,16,3061,8,0,3064,0,
			16,3067,0,0,3070,8,18,3073,18,0,3079,0,0,3082,0,0,3094,16,
			16,3085,8,0,3088,0,16,3091,0,0,3094,18,18,3097,15,0,3100,
			0,18,3103,0,0,3106,17,17,3109,0,0,3112,0,17,3115,0,0,3118,
			18,0,3124,0,0,3127,0,0,3139,17,17,3130,8,0,3133,0,17,3136,
			0,0,3139,8,18,3142,18,0,3148,0,0,3151,0,0,3163,17,17,3154,
			8,0,3157,0,17,3160,0,0,3163,16,0,3166,0,17,3169,0,0,3172,
			8,17,3175,16,16,3178,9,0,3181,0,16,3184,0,0,3187,17,0,3193,
			0,0,3199,0,0,3196,0,17,3211,16,16,3202,0,0,3205,0,16,3208,
			0,0,3211,16,0,3214,0,14,3217,0,0,3220,15,0,3223,0,15,3226,
			0,0,3229,44,0,3232,0,44,3235,0,0,3238,9,13,3241,0,0,3004,
			44,44,3247,14,0,3250,0,44,3253,0,0,3256,0,0,85,13,13,3262,
			11,0,3265,0,13,3268,0,0,3271,14,14,3274,3289,3289,3277,48,0,
			3280,0,3289,3283,0,0,3286,15,15,3289,0,0,3292,0,15,3295,0,
			0,3298,8,48,3301,13,0,3307,0,0,3313,0,0,3310,0,13,3547,14,
			0,3316,0,14,3319,0,0,3322,18,18,3325,44,0,3328,0,18,3331,
			0,0,3334,16,16,3337,0,0,3340,0,16,3343,0,0,3346,18,0,3352,
			0,0,3355,0,0,3367,16,16,3358,8,0,3361,0,16,3364,0,0,3367,
			8,18,3370,18,0,3376,0,0,3379,0,0,3391,16,16,3382,8,0,3385,
			0,16,3388,0,0,3391,18,18,3394,15,0,3397,0,18,3400,0,0,3403,
			17,17,3406,0,0,3409,0,17,3412,0,0,3415,18,0,3421,0,0,3424,
			0,0,3436,17,17,3427,8,0,3430,0,17,3433,0,0,3436,8,18,3439,
			18,0,3445,0,0,3448,0,0,3460,17,17,3451,8,0,3454,0,17,3457,
			0,0,3460,16,0,3463,0,17,3466,0,0,3469,10,0,3472,0,17,3475,
			0,0,3478,16,16,3481,9,0,3484,0,16,3487,0,0,3490,17,0,3496,
			0,0,3502,0,0,3499,0,17,3514,16,16,3505,0,0,3508,0,16,3511,
			0,0,3514,16,0,3517,0,14,3520,0,0,3523,15,0,3526,0,15,3529,
			0,0,3532,44,0,3535,0,44,3538,0,0,3541,9,13,3544,0,0,3301,
			44,44,3550,14,0,3553,0,44,3556,0,0,3559,0,0,85,3577,3577,
			3565,48,0,3568,0,3577,3571,0,0,3574,13,13,3577,0,0,3580,0,
			13,3583,0,0,3586,15,15,3589,14,14,3592,9,0,3595,0,14,3598,
			0,0,3601,13,0,3607,0,0,3610,0,0,3622,14,14,3613,0,0,3616,
			0,14,3619,0,0,3622,14,0,3628,0,0,3634,0,0,3631,0,14,3643,
			8,15,3637,44,13,3640,0,0,3589,44,0,3646,0,13,3649,0,0,3652,
			9,15,3655,44,44,3658,15,0,3661,0,44,3664,0,0,3667,3703,3703,
			3670,48,0,3673,0,3703,3676,0,0,3679,3704,3704,3682,48,0,3685,
			0,3704,3688,0,0,3691,3710,3710,3694,48,0,3697,0,3710,3700,0,
			0,3703,0,0,3706,13,0,3709,0,0,3712,0,0,3715,0,0,85,40,0,
			3724,0,0,3730,0,0,3727,0,40,3733,0,0,85,3748,3748,3736,20,
			0,3739,0,3748,3742,0,0,3745,13,13,3748,0,0,3751,0,13,3754,
			0,0,3757,13,0,3763,0,0,3769,0,0,3766,0,13,4156,8,39,3772,
			15,15,3775,20,0,3778,0,15,3781,0,0,3784,8,15,3787,3823,3823,
			3790,15,0,3793,0,3823,3796,0,0,3799,3824,3824,3802,15,0,3805,
			0,3824,3808,0,0,3811,3830,3830,3814,15,0,3817,0,3830,3820,
			0,0,3823,0,0,3826,43,0,3829,0,0,3832,0,0,3835,8,15,3838,
			3874,3874,3841,15,0,3844,0,3874,3847,0,0,3850,3875,3875,3853,
			15,0,3856,0,3875,3859,0,0,3862,3881,3881,3865,15,0,3868,0,
			3881,3871,0,0,3874,0,0,3877,44,0,3880,0,0,3883,0,0,3886,8,
			15,3889,3925,3925,3892,15,0,3895,0,3925,3898,0,0,3901,3926,
			3926,3904,15,0,3907,0,3926,3910,0,0,3913,3932,3932,3916,15,
			0,3919,0,3932,3922,0,0,3925,0,0,3928,46,0,3931,0,0,3934,0,
			0,3937,8,15,3940,3976,3976,3943,15,0,3946,0,3976,3949,0,0,
			3952,3977,3977,3955,15,0,3958,0,3977,3961,0,0,3964,3983,3983,
			3967,15,0,3970,0,3983,3973,0,0,3976,0,0,3979,48,0,3982,0,
			0,3985,0,0,3988,8,15,3991,45,45,3994,13,0,3997,0,45,4000,
			0,0,4003,6,0,4006,0,45,4009,0,0,4012,47,47,4015,45,0,4018,
			0,47,4021,0,0,4024,6,0,4027,0,47,4030,0,0,4033,20,20,4036,
			13,0,4039,0,20,4042,0,0,4045,8,13,4048,4063,4063,4051,13,0,
			4054,0,4063,4057,0,0,4060,43,43,4063,0,0,4066,0,43,4069,0,0,
			4072,8,13,4075,4090,4090,4078,13,0,4081,0,4090,4084,0,0,4087,
			44,44,4090,0,0,4093,0,44,4096,0,0,4099,8,13,4102,4117,4117,
			4105,13,0,4108,0,4117,4111,0,0,4114,46,46,4117,0,0,4120,0,
			46,4123,0,0,4126,8,13,4129,4144,4144,4132,13,0,4135,0,4144,
			4138,0,0,4141,48,48,4144,0,0,4147,0,48,4150,0,0,4153,8,13,
			4156,0,0,85,0,8962,48,493,0,1168,8318,8962,49,493,1,1168,
			8330,8963,12589,493,-1,1168,0,12546,43,241,1168,8354,12546,45,
			235,1168,8364,11009,1243,1168,8374,11521,1198,1168,8382,26886,
			30318,29285,116,247,1168,8390,25091,25977,229,1168,8404,25603,
			28789,760,1168,8414,25604,28530,112,904,1168,8424,28420,25974,
			114,814,1168,8436,29444,24951,112,673,1168,8448,29190,26739,
			26217,116,2518,1168,8342,23299,23872,271,1168,8474,23299,23841,
			298,1168,8484,27651,25203,1693,1168,8460,29443,16496,1366,1168,
			8504,29443,8560,1435,1168,8514,12290,62,2047,1168,8524,12290,61,
			2089,1168,8534,12290,60,2158,1168,8544,15361,2230,1168,8554,15873,
			2296,1168,8562,12802,47,2368,1168,8570,28418,114,2698,1168,8580,
			30723,29295,2962,1168,8590,24835,25710,3259,1168,8600,10753,1096,
			1168,8610,28677,30049,25971,3718,1168,8618,28163,28783,1168,8630,
			16385,2368,271,1168,8638,8449,2368,298,1168,8648,15364,27503,62,
			574,24,1168,8494,15366,28005,29801,62,574,20,1168,8672,15365,
			25963,15993,574,18,1168,8688,15366,25445,28520,62,574,26,1168,
			8702,15369,26988,25972,24946,15980,574,22,1168,8718,15366,28515,
			25708,62,493,72,1168,8658,25351,29301,25970,29806,493,62,1168,
			8752,29192,28527,11636,28534,99,493,68,1168,8768,29700,26984,115,
			574,0,1168,8786,8965,28534,29539,493,8,1168,8800,25351,28271,
			25972,29816,493,46,1168,8814,26628,29285,101,493,38,4321,1168,
			8830,28675,25697,4397,493,960,1243,1168,8846,25092,29537,101,
			574,10,1168,8862,25603,27760,574,12,1168,8876,26627,25708,574,
			14,1168,8888,29445,24948,25972,574,28,1168,8736,25355,27745,
			25193,24946,26996,28271,493,42,1168,8900,25091,27500,493,82,
			1168,8934,29443,29283,493,84,1168,8946,15875,28265,574,16,1168,
			8958,25090,108,493,32,1168,8970,26627,30821,493,16,4435,4326,
			1168,8982,25607,25445,28009,27745,493,10,4435,4326,1168,8914,
			27908,28257,121,4162,4482,4326,1168,8998,25350,25465,25964,115,
			493,78,1168,9034,23809,4174,4454,4326,1168,9050,23361,4162,4454,
			4326,1168,9062,28163,28777,673,904,1168,9074,29700,25461,107,673,
			814,1168,9086,16132,30052,112,760,1897,4558,760,1168,9100,29187,
			29807,934,673,1015,673,1168,9118,11524,28530,116,4562,4562,1168,
			9134,12805,29284,28783,904,904,1168,9148,12804,30052,112,814,
			814,1168,9162,12291,15676,2047,2089,1168,9176,12291,15932,2089,
			2089,1168,9188,15617,1198,2089,1168,9200,15362,62,4602,2089,1168,
			9210,15874,61,2230,2089,1168,9222,15362,61,2296,2089,1168,9234,
			12291,15678,2158,2089,1168,9246,28166,26469,29793,101,235,247,
			1168,9258,29443,25662,760,2158,1168,9274,24835,29538,4640,1897,
			4650,4634,1168,9286,12802,42,2356,1168,9302,25348,27749,108,493,
			2,1168,9312,25349,27749,11116,4660,1243,1168,9326,25349,27749,
			29548,2356,1168,9340,29954,60,4585,2158,2089,673,2158,2089,4608,
			934,2230,1015,4608,1168,9352,29954,62,673,4679,1168,9382,29955,
			15678,4679,2089,1168,9394,29955,15676,4694,2089,1168,9406,25863,
			25976,30051,25972,2368,934,1168,9418,27396,31077,63,436,4640,
			1897,4737,493,6,4321,493,8,3259,1897,4734,229,904,4162,1168,
			4174,1168,9434,27395,31077,3718,4348,4321,4714,1897,4742,1168,
			9478,25860,26989,116,3718,4341,4321,4714,1168,9498,25346,114,
			493,13,4753,493,10,4753,1168,9516,26379,29797,25389,29301,25970,
			29806,4381,4321,1168,9536,29451,29797,25389,29301,25970,29806,
			4381,4326,1168,9018,27652,29537,116,4775,4321,1168,9556,28676,
			25449,107,1366,1243,271,1168,9590,11010,33,2368,4547,271,1243,
			673,298,1168,9606,27654,26739,26217,116,4554,1897,4827,235,673,
			4654,673,1870,4818,1168,9626,25346,64,760,4321,673,1693,1897,
			4842,493,8,2518,1870,4845,493,255,3259,1168,9656,25346,33,673,
			493,255,3259,760,493,8,4818,2698,673,4547,760,4321,673,1693,
			2089,493,255,2962,934,814,2962,1015,3259,2962,673,4326,1168,
			9692,27907,30817,4585,2230,1897,4887,4540,1870,4888,904,1168,
			9754,27907,28265,4585,2296,1897,4899,4540,1870,4900,904,1168,
			9778,29449,30063,25458,11621,25705,574,36,4321,1168,9802,12802,
			33,4547,4326,4667,4326,1168,9822,12802,64,760,4667,4321,673,
			4321,1168,9838,29699,28789,574,38,1168,9856,29446,30063,25458,
			101,4931,4922,1168,9868,12835,29246,1015,673,934,673,934,934,
			1168,9884,12835,15986,1015,1015,673,1015,673,934,1168,9904,25349,
			30063,29806,760,241,673,4831,1168,9924,24839,26988,28263,25701,
			760,1693,4597,4168,3259,1243,1168,9942,24837,26988,28263,4419,
			4976,493,38,4326,1168,9966,11015,29811,26994,26478,4168,814,
			4892,4562,814,1243,4562,4562,1198,1168,9986,29700,28793,101,
			760,1897,5022,673,4966,4753,673,235,1870,5012,4578,1168,10016,
			25349,28525,25974,934,1870,5039,934,760,4831,1282,4849,241,1015,
			241,1558,5031,4578,1168,10048,26116,27753,108,673,934,673,1870,
			5055,4585,4849,241,1558,5052,4578,1168,10086,25861,24946,25971,
			4162,5047,1168,9576,25603,9327,1015,1015,4654,760,4966,1243,4976,
			2368,934,673,934,1168,10132,10243,10532,5069,1168,10162,11778,36,
			5069,4966,5012,1168,10118,29445,24944,25955,4488,4753,1168,10186,
			25349,29793,26723,1366,934,574,30,4321,934,1450,574,30,4326,
			4714,1015,574,30,4326,1360,4162,1168,10200,29701,29288,30575,
			4554,1897,5143,574,30,4321,1516,1015,574,30,4326,1015,673,934,
			1435,904,1015,1168,10244,24837,28514,29810,4174,5126,1168,10172,
			10247,25185,29295,10612,5069,673,1897,5163,4966,5012,5148,904,
			1168,10288,29955,11117,4585,1243,934,1282,4162,4614,934,4585,
			3259,2158,1015,2698,934,2698,2158,1015,3259,247,241,1015,673,
			1168,10330,25607,25966,24935,25972,247,934,247,4168,5168,1015,
			1243,1168,10380,25602,43,934,673,934,5168,1015,1243,1015,1243,
			1168,10406,29955,10861,4162,673,493,15,934,760,5168,934,934,
			760,5168,1015,1243,1015,1897,5239,934,814,5168,1015,1243,1558,
			5223,4562,904,1168,10430,29958,12141,28525,100,4554,2089,1897,
			5256,493,-10,5126,4585,4679,1897,5299,4634,493,15,934,934,760,
			5168,934,934,760,5168,1015,1243,760,1015,1282,673,934,5168,1015,
			4597,673,4597,1243,1897,5292,934,904,241,1015,1870,5293,904,1015,
			1558,5264,904,673,1168,4578,904,4174,760,1168,10488,27909,27951,
			25711,4640,760,934,1897,5317,4634,934,5195,1015,934,4640,1897,
			5323,1282,1243,1015,5249,1015,1897,5332,673,4634,673,1168,1168,
			10608,12036,28525,100,814,2158,673,5308,1168,10666,27907,25711,
			5337,904,1168,10684,12033,5337,4540,1168,10302,25605,28773,26740,
			493,94,4321,1366,1198,235,1168,10706,10246,28005,29801,41,403,
			1168,10696,25860,26723,111,4356,4321,4714,1168,10728,29699,28769,
			760,5375,814,4849,241,1168,10758,27396,24948,112,760,760,493,
			13,4608,934,493,10,4608,1015,3259,1897,5437,760,493,8,4608,
			934,493,127,4608,1015,3259,1897,5420,4488,5382,1168,934,814,
			1282,2230,760,1897,5434,493,8,760,5375,4488,5375,5375,1015,
			1243,1168,904,4540,760,1168,10742,24838,25443,28773,116,814,
			1243,814,4585,4608,1897,5468,4742,760,4488,1198,493,95,4679,
			1897,5465,5382,1870,5466,5392,1870,5449,904,814,1198,1168,10882,
			29699,25193,4939,904,1168,10944,28933,25973,31090,5475,493,256,
			5446,4931,4326,904,4162,4482,4326,1168,10776,16134,25956,29808,
			104,5357,2296,1897,5505,493,-4,5126,1168,10956,11529,29300,26977,
			26988,26478,934,1870,5526,4488,814,1282,1243,4831,2230,1897,5526,
			1015,241,1168,1558,5515,4162,1168,10986,27652,28527,107,673,934,
			4562,4562,760,1897,5561,814,4831,1282,1198,1282,4488,4602,493,
			4,4799,4714,1897,5558,1360,4562,904,1168,4998,1870,5538,1360,
			4562,904,1168,11060,29959,28014,29793,26723,1897,5574,2047,1168,
			4597,1168,11130,27909,29793,26723,5570,247,1168,11012,28677,29281,
			25971,934,5475,4482,4321,1243,4931,4321,4482,4321,1198,1282,934,
			814,1015,673,934,934,1282,493,11140,5534,4585,1015,493,11160,
			5534,673,1015,1198,934,1198,1015,241,4482,4806,1015,4488,4602,
			1897,5628,5512,4162,4880,1168,11152,25094,28257,25966,114,934,
			760,2047,1897,5646,1282,4753,235,1870,5637,904,1360,1168,11166,
			26628,27759,100,4174,4447,4806,4447,4321,4849,1168,11298,8962,
			62,4578,4447,4321,4397,493,896,1243,814,1198,1168,11262,25863,
			29816,24946,29795,760,934,5249,1015,673,934,5249,1015,4562,1168,
			11346,25605,26473,29801,493,9,814,2230,493,7,3259,1243,493,48,
			1243,1168,11320,8961,493,2,5498,4162,4435,4321,5678,5692,5653,
			1168,11408,8962,115,5706,4585,2698,2089,1897,5719,1168,11432,
			15362,35,4397,493,896,1243,4447,4326,1168,11452,29444,26473,110,
			2158,1897,5746,493,45,5653,1168,11472,29955,29230,934,4162,5729,
			5719,5663,1015,814,1198,4488,5636,5012,1168,11494,29954,46,4162,
			5729,5719,5663,5097,5012,1168,11376,10243,10542,4646,4435,4321,
			3562,4554,1897,5783,5775,5692,4753,1168,11524,11777,5097,760,
			2158,1897,5796,493,45,4753,5775,1168,11572,15879,30062,25197,
			29285,4585,934,934,904,4831,4435,4321,934,493,48,1198,493,9,
			814,2230,1897,5828,493,7,1198,760,493,10,2230,2698,760,1015,
			4679,2089,1897,5838,904,1015,1015,1168,673,4435,4321,5218,904,
			4562,4435,4321,5218,5206,1015,1015,4998,760,2089,1897,5803,1168,
			11596,28167,28021,25954,16242,4174,4441,4326,4435,4321,934,814,
			4831,493,45,4602,760,934,1897,5877,4998,814,4831,493,36,4602,
			1897,5886,4494,4998,934,934,4162,760,1015,1015,5803,760,1897,
			5921,814,4831,493,46,4608,1897,5913,4562,904,4562,1015,4578,
			4162,1015,4435,4326,1168,235,4441,4326,241,4441,4321,1870,5892,
			4578,1015,1897,5926,5195,1015,4435,4326,4174,1168,11712,25351,
			28015,24944,25970,4562,814,1198,4554,1897,5947,934,4578,1015,4540,
			1168,934,1870,5962,4966,4562,4966,4562,1198,4554,1897,5962,1360,
			4540,4540,1168,1558,5950,4578,4162,1168,11862,11778,115,5357,
			934,1870,5977,1282,4799,5788,1558,5974,1168,11934,28163,24934,
			4667,1168,11960,25347,24934,5983,760,4831,493,31,3259,1243,4667,
			4660,4634,3259,1168,11970,24837,27756,29807,4976,493,38,4806,
			1168,12000,11265,4987,4419,4326,4660,6004,1168,11544,10257,25971,
			29281,26723,30509,29295,27748,29545,10612,673,934,760,760,1897,
			6063,760,5983,4966,493,159,3259,1282,4966,5936,2089,1897,6058,
			1360,760,5983,493,64,673,4321,3259,4597,4168,2698,4634,1168,
			4540,760,4321,1870,6030,1360,4578,4162,1168,12034,10246,26982,
			25710,41,934,4412,760,4321,1897,6096,760,4321,4321,1282,673,
			6027,4554,1897,6093,934,4562,904,1015,1360,1168,4667,1870,6074,
			904,4162,1015,4162,1168,12018,29455,24933,25458,11624,28535,25714,
			26988,29811,6027,4562,904,1168,12202,26116,28265,100,6072,4562,
			904,1168,12134,10249,26988,25972,24946,10604,4454,4321,1897,6136,
			493,493,6011,6011,1168,12228,27719,29801,29285,27745,4365,4321,
			4714,1168,12274,25352,28015,26992,25964,44,2368,4987,6011,1168,
			12244,16134,28518,28277,100,1897,6164,1168,5097,4966,5012,493,63,
			4753,4761,493,-13,5126,1168,12292,26889,29806,29285,29296,29797,
			6118,4554,1897,6213,4454,4321,1897,6198,2047,1897,6195,5988,4714,
			1168,5988,6152,1168,904,760,5983,4831,493,32,3259,1897,6210,493,
			-14,5126,5988,4714,1168,760,934,4966,5861,1897,6236,1360,4441,
			4321,2158,1897,6228,904,1870,6234,4454,4321,1897,6233,673,6142,
			6142,1168,1015,4162,6161,1168,12312,11779,25705,5983,4966,493,
			31,3259,5012,5097,1168,12350,26377,29797,28461,25714,29285,4412,
			4162,934,760,4321,1282,2962,1897,6269,4667,1870,6260,1360,760,
			4660,1198,673,4412,1198,2368,760,934,235,4640,1897,6286,493,-80,
			5126,934,1870,6294,760,4321,673,4660,1198,1558,6289,4321,1015,
			1168,0,29449,29797,28461,25714,29285,760,4174,4602,1897,6315,
			904,4390,4168,6305,1168,760,4404,2296,1897,6323,493,-73,5126,
			4412,673,934,1870,6331,4547,4326,4667,1558,6328,4162,673,4326,
			1168,12598,26126,29295,26740,30509,29295,27748,29545,116,493,64,
			1168,12674,29446,29561,25972,109,493,70,1168,12698,26117,29295,
			26740,4390,6346,493,2,6305,1168,12714,28420,27758,121,4174,6305,
			1168,12734,30469,29295,29540,4761,6257,4554,1897,6405,673,4321,
			4554,1897,6402,760,5983,4831,493,128,3259,2089,1897,6399,760,
			6243,4321,1870,6385,235,1870,6380,1168,12502,25611,26213,28265,
			29801,28521,29550,4412,4321,4785,1168,12812,30468,29295,100,5587,
			4419,760,934,4585,4326,241,673,5028,1015,1168,12480,16135,28277,
			29033,25973,760,4775,6027,2089,1897,6444,1168,5097,4578,493,76,
			4321,6243,5089,29193,25701,26213,28265,25701,4761,1168,12864,16132,
			30062,108,760,4831,1897,6467,1168,493,-16,5126,1168,12834,25348,
			24936,114,4488,6421,6462,4966,904,4831,1168,12942,23366,26723,
			29281,93,6475,493,493,6011,6011,1168,12964,15201,493,-17730,
			4608,1897,6503,493,-22,5126,493,1168,6011,4533,4554,1897,6513,
			4775,4326,1168,1168,12986,14849,4987,4419,760,493,76,4326,4792,
			6011,4488,6421,6462,6437,4966,1243,493,38,4326,4987,493,-17730,
			4527,1168,13028,14855,28526,24942,25965,4419,493,-17730,4527,1168,
			13076,25189,26469,28265,4987,4419,1168,13096,30053,29806,27753,
			493,1897,6011,2368,6011,1168,13110,24933,24935,28265,493,1870,
			6011,2368,6011,1168,13130,26978,102,493,1897,6011,4419,4162,
			6011,1168,13150,29796,25960,110,4419,2368,673,4326,1168,13170,
			30565,26984,25964,6578,1168,13188,29286,28773,24933,116,673,6569,
			6589,1168,13200,25956,29548,101,493,1870,6011,4419,4162,6011,673,
			6589,1168,13218,26211,29295,493,934,6011,4419,1168,13244,24931,
			29798,904,493,1870,6011,4419,4162,6011,4987,4419,673,1168,13260,
			28260,30821,116,493,1558,6011,2368,6011,1168,13288,10049,4488,
			6421,6118,6161,5988,6142,1168,13308,25383,28015,26992,25964,1015,
			760,271,6011,241,934,1168,13326,29287,25445,29301,25971,493,76,
			4321,5988,6152,1168,12916,29702,26479,27751,101,4547,4321,2962,
			673,4326,1168,13372,26628,25705,101,4488,6421,6118,6161,5983,
			493,128,673,6691,1168,13394,10245,24950,10610,1015,4654,1168,
			13422,10247,28515,29550,10612,1015,271,1168,13436,10248,24941,
			27506,29285,41,1015,4654,760,4321,493,38,4326,4667,4321,4775,
			4326,1168,13350,25350,25970,29793,101,6516,904,4533,6668,6715,
			4775,4326,1168,13488,30216,29281,24937,27746,101,6749,4162,6011,
			1168,13514,25352,28271,29811,28257,116,6749,4660,4634,6004,6668,
			6723,6011,1168,13534,27910,29281,25963,114,4792,4419,6749,4660,
			4634,6004,6668,6732,6011,6011,1168,13562,15909,28514,31076,4667,
			1168,13452,10246,28516,29541,41,1015,1015,4654,673,934,1168,13606,
			10246,28515,28781,41,1015,493,76,4321,5988,4326,1168,13594,25701,
			25967,15987,6668,6819,6668,6808,1168,13652,29283,8560,6668,1516,
			1168,13670,29283,16496,6668,1450,1168,13682,15970,114,6668,934,
			1168,13694,29282,62,6668,1015,1168,13706,29282,64,6668,1282,
			1168,13718,29285,29284,28783,6668,1360,1168,13730,25956,27000,
			116,6668,1168,1168,13744,11874,34,6668,5089,493,34,6421,4966,
			1243,493,38,4326,4987,1168,13758,9314,34,6668,5084,493,34,6421,
			4966,1243,493,38,4326,4987,1168,13788,24934,28514,29810,34,6668,
			5156,493,34,6421,4966,1243,493,38,4326,4987,1168,13818,10305,
			493,41,5587,4578,1168,13852,11842,40,493,41,5587,5012,1168,
			13866,28744,29551,28788,28271,101,4488,6421,6118,6161,5988,6152,
			1168,13882,10561,1168,13908,23617,5475,4321,4482,4326,1168,13914,
			26889,28013,25701,24937,25972,4792,5983,4321,493,64,2698,4792,
			5983,4326,1168,13928,29443,25957,4488,6421,6118,6161,4761,760,
			4321,493,1168,4608,1897,7008,760,4321,5788,4667,4419,814,2230,
			1897,7006,904,1168,1870,6988,4321,5765,1168,13960,25604,28021,
			112,4976,4554,1897,7029,673,760,4321,5788,4667,673,4660,1198,
			1870,7016,904,1168,13628,25349,29547,28021,4976,760,493,-16162,
			1198,934,4554,1897,7056,673,760,4321,1015,1243,934,4667,673,4660,
			1198,1870,7041,904,1015,1168,14022,25607,26213,28265,25701,4488,
			6421,6118,4540,4597,1168,14118,23366,26740,28261,93,1168,14140,
			23366,27749,25971,93,4488,6421,760,4831,1897,7104,6118,904,5988,
			760,493,14162,4602,673,493,14150,4602,2698,1897,7102,1168,1870,
			7081,5482,1870,7081,1168,14152,23364,26217,93,1897,7115,1168,7081,
			1168,14216,25092,27749,108,493,7,4753,1168,14234,27906,115,934,
			3718,4464,4321,934,1558,7133,1558,7129,1168,14062,25347,26995,
			493,27,4753,493,91,4753,1168,14250,28676,26465,101,7141,5089,
			12802,74,7141,5089,12548,12603,72,1168,14296,24837,11636,31096,
			4435,4321,4504,934,7141,4162,5750,5089,15105,4162,5750,5089,18433,
			1015,4435,4326,1168,14324,25093,25135,26229,493,1024,1168,14366,
			25093,28524,27491,4168,5498,760,4470,4326,493,10,4818,3718,1168,
			14380,26117,30060,26739,1168,14408,29958,25712,29793,101,4174,493,
			74,4326,1168,14418,25093,24940,27502,4488,5047,1168,14438,27652,
			29545,116,7152,4761,760,4476,4326,7194,493,15,934,493,15,1282,
			1198,493,3,5750,5097,493,63,934,4966,4753,1558,7250,4761,1558,
			7239,904,1168,14452,26377,29797,26925,28782,29813,4939,4482,4321,
			4907,4333,4321,1168,14518,29449,29797,26925,28782,29813,4333,4326,
			574,36,4326,4482,4326,4931,4914,1168,14276,28418,107,4454,4321,
			2089,1897,7300,5089,8195,27503,4761,1168,14576,25860,24950,108,
			4488,6421,760,4831,1897,7316,6181,4168,5498,1870,7305,904,4333,
			4321,4714,1168,14544,25864,24950,30060,29793,101,7265,4945,4945,
			934,4162,4174,493,8636,7278,493,14610,5104,1015,4955,4955,7278,
			5126,1168,14602,27652,28265,101,493,6,4818,673,7194,1243,493,
			64,1168,14690,27656,24943,27748,28265,101,7349,7327,1168,14642,
			27652,24943,100,4162,493,15,934,4585,4945,7364,4955,241,1558,
			7375,4578,1168,12748,25862,28518,29810,104,493,262,1168,14716,
			26884,26222,111,4761,5089,20501,28530,25962,29795,8250,18021,
			29295,26740,30240,11825,8246,4761,5089,16667,29813,28520,14962,
			8224,26962,26723,29281,8292,24906,25965,8307,28488,25975,4761,
			5089,17694,24941,27753,8250,8224,28520,25975,29230,27182,14382,
			16441,28007,26977,11884,28515,109,4761,5089,21033,28773,14959,
			8224,8224,29800,28788,14963,12079,26983,26740,25205,25390,28015,
			26671,30575,29285,12138,30067,27746,29029,4761,5089,19494,25449,
			28261,25971,8250,26708,8293,28245,26988,25955,29550,8293,8239,
			30032,27746,25449,17440,28015,26977,110,4761,1168,14784,29705,
			29537,11627,28265,29801,493,40,4321,673,493,40,4326,4397,2368,
			574,0,4326,493,8636,2368,574,2,4326,4397,493,256,1243,2368,
			574,6,4326,4397,493,512,1243,2368,574,8,4326,4162,574,4,4326,
			4504,493,9442,4348,4326,493,10738,4356,4326,493,6,4321,1693,
			1897,7553,493,8432,4356,4326,493,10738,4341,4326,493,14582,
			4333,4326,493,12256,4365,4326,4162,4482,4326,4174,4441,4326,
			4397,493,512,1243,4162,4931,4914,4533,493,40,4326,1168,14980,
			26883,26990,493,40,4321,7496,1168,15166,28420,29808,115,493,6,
			4321,1693,1897,7605,493,8432,4356,4326,493,6,4321,493,4,3259,
			1897,7614,7396,493,6,4321,493,2,3259,1897,7654,493,8,4321,
			4654,760,4419,673,1198,7035,493,44,4321,4608,1897,7645,5089,
			25354,29547,28021,26144,26977,108,229,493,6,4321,493,2,2962,
			493,6,4326,1168,14734,28932,26997,116,6371,6361,6413,7586,7595,
			5482,493,14610,5104,4554,1897,7684,760,5097,5788,493,63,4753,
			4761,4174,4602,1897,7683,229,7586,1870,7664,1168,15310,29701,
			29537,14955,6749,4419,493,1024,6004,2368,7496,1168,15374,24840,
			29795,30313,29793,101,760,7496,760,934,673,2368,673,493,2,1243,
			4326,1015,4397,4321,934,760,2368,4397,4326,1015,673,4326,1168,
			15398,30468,26977,116,3718,760,4321,1897,7732,4162,673,4326,1168,
			15456,29446,26473,24942,108,4397,673,4326,1168,15482,29446,28265,
			27751,101,4168,493,80,4326,1168,15500,27909,27765,26996,4162,
			493,80,4326,1168,15520,29444,28261,100,4397,814,493,32,1243,
			3718,760,4321,2089,1897,7778,4326,493,34,1243,4326,1168,15538,
			29191,25445,26981,25974,3718,574,32,4321,1897,7795,574,34,4321,
			574,32,4321,4162,574,32,4326,1168,15580,25862,26980,28532,114,
			493,66,4168,6305,1168,0,28929,6371,6361,1168,15644,16129,4476,
			4321,5788,1168,15654,27649,4476,4321,7230,1168,15666,25857,7824,
			4476,4321,7371,7817,1168,15678,26882,97,493,2,5498,493,6,4818,
			1243,4476,4321,7194,1243,5475,4482,4321,1243,673,4939,4540,4482,
			4321,1198,5028,5475,4321,4482,4326,7214,7835,1168,15694,26881,
			4162,673,7850,1168,15758,30465,6378,1168,15770,29441,7214,7208,
			1168,15778,28161,4168,4476,4806,7835,1168,15788,28673,4174,4476,
			4806,7835,1168,15802,29185,4476,4326,7835,1168,15816,30721,4476,
			4321,7194,7187,7223,7835,1168,15828,25601,493,1,5498,934,4476,
			4321,7194,1015,493,6,4818,1243,493,64,7223,7835,1168,15624,
			25348,27759,100,493,72,4321,4714,1168
		];

		function updateDump() {
			function dump(a, as, base) {
				function isgraph(u) {
					return u >= 32 && u < 127;
				}
				function char(u) {
					return isgraph(u) ? String.fromCharCode(u) : ".";
				}
				function chars(u) {
					return char(u & 255) + char((u >> 8) & 255);
				}
				function maxPad(max, base) {
					return Math.ceil(Math.log(max) / Math.log(base));
				}
				function pad(number, length) {
					var str = "" + number;
					while (str.length < length) str = "0" + str;
					return str;
				}
				var r = "", p = maxPad(65536, base), cols = 12 - p;
				for (let i = 0; i < as; i += cols) {
					var l = pad(i.toString(base), p) + ": ";
					for (let j = 0; j < cols && (i + j) < as; j++) {
						l += pad(m[i+j].toString(base), p) + " ";
					}
					l += "\t|";
					for (let j = 0; j < cols && (i + j) < as; j++) {
						l += chars(m[i+j]);
					}
					r += l + "|\n";
				}
				return r;
			}
			let base = document.getElementById("base").value;
			base = base > 36 || base < 2 ? 16 : base;
			document.getElementById("dump").innerHTML = dump(m, 65536, base);
		}

		function downloadTextAsFile(filename, text) {
			var e = document.createElement("a");
			e.setAttribute("href", "data:text/plain;charset=utf-8," + encodeURIComponent(text));
			e.setAttribute("download", filename);
			e.style.display = "none";
			document.body.appendChild(e);
			e.click();
			document.body.removeChild(e);
		}

		function openTab(evt, name) {
			let tabcontent = document.getElementsByClassName("tabcontent");
			for (let i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = "none"; }
			let tablinks = document.getElementsByClassName("tablinks");
			for (let i = 0; i < tablinks.length; i++) { tablinks[i].className = tablinks[i].className.replace(" active", ""); }
			document.getElementById(name).style.display = "block";
			evt.currentTarget.className += " active";
			focused = false;
			switch (name) {
			case "subleq": queueDraw(); focused = true; break;
			case "image": updateDump(); break;
			}
		}

		function saveImage() {
			function isNumeric(str) {
				if (typeof str != "string") return false;
				return !isNaN(str) && !isNaN(parseFloat(str));
			}
			function save(filename, data) {
				var blob = new Blob([data], {type: "text/plain"});
				if (window.navigator.msSaveOrOpenBlob) {
					window.navigator.msSaveBlob(blob, filename);
					return;
				}
				var elem = window.document.createElement("a");
				elem.href = window.URL.createObjectURL(blob);
				elem.download = filename;
				document.body.appendChild(elem);
				elem.click();
				document.body.removeChild(elem);
			}
			let filename = document.getElementById("fname").value;
			let cells = document.getElementById("cells").value;
			filename = filename == undefined || filename === "" ? "subleq.dec" : filename;
			cells = isNumeric(cells) ? parseInt(cells) : 8192;
			if (cells < 0)
				cells = 0;
			if (cells > 65536)
				cells = 65536;
			let x = "";
			for (let i = 0; i < cells; i++)
				x += m[i].toString() + "\n";
			if (document.getElementById("optimizeImage").checked)
				x = x.replace(/(0\n)+$/g, "");
			save(filename, x);
		}

		function loadImageFromArray(a) {
			for (var i = 0; i < 65536; i++)
				m[i] = undefined == a[i] ? 0 : a[i];
			loaded = true;
		}

		function loadImage() {
			function loadImageFromString(str) {
				var txt = str.split(/\r?\n/g);
				for (var i = 0; i < 65536; i++)
					m[i] = undefined == txt[i] ? 0 : parseInt(txt[i]);
				loaded = true;
			}
			document.getElementById("input").files[0].text().then(t =>{ loadImageFromString(t); updateDump();});
			pc = 0;
			display = "";
			input = init;
		}

		function saveCookies() {
			function setCookie(cname, cvalue, exdays) {
				let d = new Date();
				d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
				let expires = "expires="+ d.toUTCString();
				document.cookie = cname + "=" + cvalue + "; SameSite=Strict; " + expires + ";path=/";
			}
			let expire = 365;
			setCookie("highlight",     document.getElementById("highlight").checked,     expire);
			setCookie("scroll",        document.getElementById("scroll").checked,        expire);
			setCookie("optimizeImage", document.getElementById("optimizeImage").checked, expire);
			setCookie("base",          document.getElementById("base").value,            expire);
		}

		function setValuesFromCookies() {
			function getCookie(cname, defaultVal) {
				let name = cname + "=";
				let decodedCookie = decodeURIComponent(document.cookie);
				let ca = decodedCookie.split(";");
				for(let i = 0; i < ca.length; i++) {
					let c = ca[i];
					while (c.charAt(0) == " ")
						c = c.substring(1);
					if (c.indexOf(name) == 0)
						return c.substring(name.length, c.length);
				}
				return defaultVal;
			}
			document.getElementById("highlight").checked     = getCookie("highlight", "true") == "true" ? true : false;
			document.getElementById("scroll").checked        = getCookie("scroll", "true") == "true" ? true : false;
			document.getElementById("optimizeImage").checked = getCookie("optimizeImage", "true") == "true" ? true : false;
			document.getElementById("base").value            = getCookie("base", 16);
		}

		function unesc(i) {
			i = i.replace(/&amp;/g, "&");
			i = i.replace(/&lt;/g, "<");
			return i.replace(/&gt;/g, ">");
		}

		function esc(i) {
			i = i.replace(/&/g, "&amp;");
			i = i.replace(/</g, "&lt;");
			return i.replace(/>/g, "&gt;");
		}

		function highlight(i) { /* good enough, could also <u> things */
			if (!document.getElementById("highlight").checked)
				return i;
			i = i.replace(/\b[0-9]+[^a-zA-Z=<>*\(\)\/@+&-]/g, function(x) { return "<b>" + x + "</b>"; });
			return i.replace(/\b(if|else|for|next|aft|then|while|begin|repeat|until|again)\b/g, function(x) { return "<i>" + x + "</i>"; });
		}

		function doDraw() {
			document.getElementById("subleq").innerHTML = "<pre>" + highlight(esc(display)) + cursor + "</pre>";
			if (document.getElementById("scroll").checked)
				window.scrollTo(0, document.body.scrollHeight);
		}

		function queueDraw() { /* might be better with two timers, so redraw is done at least every X ms */
			if (redrawTimeout) { /* expensive operation, do not redraw every key-press */
				clearTimeout(redrawTimeout);
				redrawTimeout = null;
			}
			redrawTimeout = setTimeout(doDraw, 50);
		}

		function backspace() {
			let last = display.slice(-1);
			if (last != "\n" && last != "\r")
				display = display.substring(0, display.length - 1);
		}

		function keyToKey(k) { /* NB. Fun to funky */
			switch (k) {
			case "Enter": return "\n";
			case "Escape": return "\u001B";
			case "Delete": case "Backspace": return "\u0008";
			default: if (k.length != 1) k = ""; return k;
			}
		}

		document.documentElement.addEventListener("keydown", function (e) {
			if (!focused) return false;
			var k = keyToKey(e.key);
			if (k.length === 0) { return false; }
			else if (k === "\u0008") { backspace(); }
			else if (k === "\u001B") { running = false; return false; }
			else { display += k; }
			input += k;
			queueDraw();
			return false;
		}, false);

		function getch() {
			if (input.length === 0)
				return -1;
			let r = input.charCodeAt(0);
			input = input.substring(1);
			return r;
		}

		function putch(ch) {
			let o = String.fromCharCode(ch);
			if (o === "\u0008") { backspace(); }
			else { display += o; }
			queueDraw();
		}

		function subleq() { /* The ISA of the future! */
			if (!loaded) { setTimeout(subleq, 20); return; }
			while ((pc & 0x8000) === 0 && running) {
				if (cycles++ > 10000000 || !focused) { cycles = 0; setTimeout(subleq, 10); return; }
				let a = m[pc+0];
				let b = m[pc+1];
				let c = m[pc+2];
				if (a === 0xFFFF) {
					let ch = getch();
					if (ch < 0) {
						setTimeout(subleq, 20);
						return;
					}
					m[b] = ch;
					pc += 3;
				} else if (b === 0xFFFF) {
					putch(m[a]);
					pc += 3;
				} else {
					let d = m[b] - m[a];
					m[b] = d;
					pc = (d & 0x8000) || (d === 0) ? c : pc + 3;
				}
				pc &= 0xFFFF;
				total++;
			}
			if (reloadOnExit)
				window.location.reload();
		}
		document.getElementsByClassName("tablinks")[0].click();
		setValuesFromCookies();
		console.log("subleq running...");
		loadImageFromArray(eForth);
		queueDraw();
		subleq();
	</script>
</body>
</html>
