<!DOCTYPE html>
<html lang="en">
<head>
	<title>SUBLEQ eForth</title>
	<meta charset="UTF-8">
	<!-- icon from https://www.favicon.cc/?action=icon&file_id=927824, looks free -->
	<link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQflAwQSNCzUzyUcAAAAZElEQVQoz31RSxYAIQiCebOdW8xBuzlt+mGWbQQVyogZWnJiC11QRjij8gFQIzWOdWtM9aIA4LnaeKn8HZZ3srRZBi268DHTsUGrBYN049w1QUx87cL+KfE1iQIR7cZy9+UJACqZqS+d7tw82QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wMy0wNFQxODo1Mjo0NCswMDowMK54rJEAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDMtMDRUMTg6NTI6NDQrMDA6MDDfJRQtAAAAAElFTkSuQmCC">
	<style type="text/css">
		body {margin:1% auto;max-width:75%;line-height:1.6;font-size:x-large;color:#444;padding:0 10px;}
		pre { white-space: pre-wrap; }
		.tab { overflow: hidden; border: 1px solid #ccc; background-color: #f1f1f1; }
		.tab button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; }
		.tab button:hover { background-color: #ddd; }
		.tab button.active { background-color: #ccc; }
		.tabcontent { display: none; padding: 6px 12px; border: 1px solid #ccc; border-top: none; }
		.blink { animation: blinker 0.6s linear infinite; color: #333333; font-size: large; font-weight: bold; }
		@keyframes blinker { 50% { opacity: 0; } }
		label.buttonHack input[type="file"] { position:absolute; top: -1000px; }
		.buttonHack { border: 2px solid #AAA; border-radius: 4px; padding: 2px 5px; margin: 2px; background: #DDD; display: inline-block; }
		.buttonHack :hover { background: #CCC; }
		.buttonHack :active { background: #CCF; }
		.tablinks { font-size: large; }

		/*:root { --primary: #2563eb; --bg-light: #f1f5f9; --bg-alert: #1d4ed8; --bg-callout: #dbeafe; --border-base: #cbd5e1; --text-base: #475569; }*/
		:root { --primary: #2563eb; --bg-light: #CCC; --bg-alert: #DDD; --bg-callout: #dbeafe; --border-base: #cbd5e1; --text-base: #475569; }
		.alert { background: var(--bg-alert); padding: 1rem; text-align: center; color: white; position: relative; transform: scaleY(1); transition: all ease-in-out .3s; }
		.alert button { border: none; background: transparent; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; position: absolute; top: 8px; right: 5px; }
		.alert button:hover { background: rgba(255, 255, 255,.35); }
		.alert-hidden { opacity: 0; padding: 0; visibility: hidden; transform: scaleY(0); transform-origin: top; transition: all ease-in-out .3s; }
		.alert button:focus { box-shadow: inset 0 0 0 2px var(--border-base); }
		.header { border-bottom: 1px solid var(--border-base); }
		.header, .footer { padding: 1rem; }
		.footer { background: var(--bg-light); padding: 1rem; }
		.header ul li, .footer ul li { display: inline; padding: 0 5px; }
		.main { max-width: 767px; padding: 1rem; margin-left: 2.75rem; margin-bottom: 2rem; }
		.callout { background: var(--bg-callout); padding: 2rem; border-radius: 6px; }
		p { color: var(--text-base); line-height: 1.4; }
		ul { list-style: none; }
		/*a { color: var(--primary); text-decoration: none; }*/
	</style>
</head>
<body>
	<div class="alert" role="alert">
		ðŸ“– <a href="https://www.amazon.com/SUBLEQ-EFORTH-Forth-Metacompilation-Machine/dp/B0B5KV548D">Don't forget to checkout my book on SUBLEQ eFORTH!</a> ðŸ“š
		<button>
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><title>close</title><g fill="none"><path stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.25 6.75l-10.5 10.5"></path><path stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6.75 6.75l10.5 10.5"></path></g></svg>
		</button>
	</div>
	<div class="tab">
		<button class="tablinks" onclick="openTab(event, 'subleq')">subleq</button>
		<button class="tablinks" onclick="openTab(event, 'image')">image</button>
		<button class="tablinks" onclick="openTab(event, 'settings')">settings</button>
		<button class="tablinks" onclick="openTab(event, 'help')">help</button>
		<button class="tablinks" onclick="openTab(event, 'about')">about</button>
	</div>
	<div id="subleq" class="tabcontent"><input type="text" class="body" id="subleq-input"></div>
	<div id="help"   class="tabcontent">
		<p>This system contains a 16-bit <a href=" https://en.wikipedia.org/wiki/One-instruction_set_computer">SUBLEQ</a>
		virtual machine, that will automatically boot an eForth image, which is a variant of
		<a href="https://en.wikipedia.org/wiki/Forth_(programming_language)">Forth</a>, a stack
		based programming language suitable for constrained systems.  What makes this system special
		is that SUBLEQ is a Turing complete <i>single instruction</i> machine, the instruction
		is short for "Subtract and Branch If Less Than Or Equal To Zero", it does a little more
		than that, but it means we do not have access to multiplication, division, addition,
		or even the basic bitwise operators such as AND or XOR in the base instruction set,
		nor calls, returns, or indirect load/stores. They all have to be synthesized.</p>
		<p>If you feel like supporting the project you can buy a book from
		Amazon, available <a href="https://www.amazon.com/SUBLEQ-EFORTH-Forth-Metacompilation-Machine-ebook/dp/B0B5VZWXPL">here</a>
		that describes how the project works and how to port a Forth to a new platform.</p>
		<p>Each SUBLEQ instruction consists of three arguments; 'a', 'b', 'c'. 'a' and 'b'
		are addresses from which arguments are loaded from, the contents of the address
		of 'a' are subtracted from the contents at 'b' and stored back into 'b', if the
		result is less than or equal to zero, then 'c' is directly jumped to, otherwise
		the program counter is incremented by three, moving to the next instruction.</p>
		<p>There are two minor special cases, one for input, and one for output, if 'a'
		is the address -1, then a byte is loaded from input and stored into the location
		pointed to by 'b', if 'b' is -1 then a byte is loaded from the location pointed
		to by 'a' and stored to output. Input is taken from the keyboard and output is
		the terminal screen in the case of this emulator.</p>
		<p>The following program, written in C, is capable of executing the same images
		that are used within this program, which you can click on to download:</p>
		<pre style="color:blue;" onclick="downloadTextAsFile('subleq.c', unesc(event.currentTarget.innerHTML))">
	#include &lt;stdio.h&gt;
	int main(int x,char**v){FILE*f=fopen(v[1],"r");short p=0,m[1&lt;&lt;16],*i=m;
	while(fscanf(f,"%hd",i++)&gt;0);for(;p&gt;=0;){int a=m[p++],b=m[p++],c=m[p++];
	a&lt;0?m[b]=getchar():b&lt;0?putchar(m[a]):(m[b]-=m[a])&lt;=0?p=c:0;}}
		</pre>
		<p>A Forth tutorial is beyond this help section. However, here are a few commands
		you can type into the system to get started: </p>
		<pre> words </pre>
		<p>This will print out a list of all of the built in functions defined in Forth.</p>
		<pre> 2 2 + . cr </pre>
		<p>Add two numbers together, both 2, and print the result, 4 along with a newline.</p>
		<pre> : ahoy cr ." Hello, World!" ; </pre>
		<p>Define a new word (functions are called "words" in Forth) named "ahoy", which when
		called like so:</p>
		<pre> ahoy </pre>
		<p>Will print the standard greeting. If the Forth interpreter is happy, "ok" will be
		printed out after entering each line. Be careful, white-space matters a lot in Forth.</p>
		<p> You can hit ESC to clear the screen and restart the system. </p>
		<p> The original SUBLEQ system, and images, came from another project of mine
		available at <a href="https://github.com/howerj/subleq">https://github.com/howerj/subleq</a>.
		You can find and load newer images there, specifically 
		<a href="https://raw.githubusercontent.com/howerj/subleq/master/subleq.dec">here</a>, which
		you should be able to load from the "image" tab. The system is self-hosting, it can be used
		to generate new eForth images if fed the right source code, although that is best done
		from the command line version and not on this web-site.</p>
		<p>The following file contains a program that can be loaded that prints "Hi", 
		<a href="javascript:downloadTextAsFile('hi.dec', atob('OQotMQozCjEwCi0xCjYKMAowCi0xCjcyCjEwNQowCg=='))">hi.dec</a>.</p>
		<p>Happy hacking!</p>
	</div>
	<div id="about" class="tabcontent">
		<table style="width:100%">
			<tr><th>Author</th><td>Richard James Howe</td></tr>
			<tr><th>Project</th><td>eForth running on SUBLEQ</td></tr>
			<tr><th>Email</th><td><a href="mailto:howe.r.j.89@gmail.com?subject=eForth SUBLEQ">howe.r.j.89@gmail.com</a></td></tr>
			<tr><th>Repo</th><td><a href="https://github.com/howerj/subleq-js">https://github.com/howerj/subleq-js</a></td></tr>
			<tr><th>License</th><td><a href="https://raw.githubusercontent.com/howerj/subleq/master/LICENSE">The Unlicense</a> / Public Domain</td></tr>
		</table>
	</div>
	<div id="settings" class="tabcontent">
		<input type="checkbox" id="highlight" name="highlight" onchange="saveState()" checked>
		<label for="highlight">highlight </label><br>
		<input type="checkbox" id="scroll" name="scroll" onchange="saveState()"  checked>
		<label for="scroll">scroll </label><br>
		<input type="checkbox" id="optimizeImage" name="optimizeImage" onchange="saveState()" checked>
		<label for="optimizeImage">remove trailing zeros on save </label><br>
		<input type="checkbox" id="hideAlert" name="hideAlert" onchange="saveState()" checked>
		<label for="hideAlert">hide alert about my rad e-book</label><br>
		<label for="base">base </label>
		<input type="number" id="base" name="base" min="2" max="36" onchange="saveState()" value=16>
	</div>
	<div id="image" class="tabcontent">
		<div>
			<label class="buttonHack"> <button hidden onclick="saveImage()">save</button> <span>save</span></label>
			<label for="fname">file</label>
			<input type="text" id="fname" name="fname" value="subleq.dec">
			<label for="cells">cells</label>
			<input type="text" id="cells" name="cells" value="8192">
		</div>
		<label class="buttonHack">
			<input type="file" id="input" oninput="loadImage()">
			<span>load</span>
		</label>
		<hr>
		<pre id="dump"></pre>
	</div>
	<canvas id="keydown"></canvas>
	<script type="text/javascript">
		const init = ".( EFORTH LOADED - USED:) here u. cr\n";
		var display = "", input = init, cursor = '<b class="blink">_</b>';
		var loaded = false, focused = false, running = true, reloadOnExit = true;
		var redrawTimeout;
		var pc = 0, cycles = 0, total = 0, m = new Uint16Array(65536);
		var eForth = [
			0,0,127,11,1828,128,-1,1,16,64,0,0,0,0,0,0,12222,32256,
			-6677,0,0,0,0,0,0,0,0,56,12204,12168,11038,11894,5796,12204,
			0,1,50,0,0,32384,32384,32512,32512,69,114,114,111,114,58,32,
			78,111,116,32,97,32,49,54,45,98,105,116,32,83,85,66,76,
			69,81,32,86,77,13,10,-1,43,11,11,79,75,0,82,0,11,85,0,
			0,88,103,103,91,11,0,94,0,103,97,0,0,100,12,12,103,0,0,
			106,0,12,109,0,0,112,6,11,115,0,12,124,12,-1,121,0,0,88,
			0,0,-1,11,11,130,6,11,133,12,12,136,6,12,139,11,0,142,0,
			11,145,0,0,148,6,12,151,13,13,154,12,0,157,0,13,160,0,0,
			163,9,13,166,0,13,172,0,0,76,0,11,178,0,0,139,8,12,181,
			12,0,187,0,0,193,0,0,190,0,12,196,0,0,76,42,42,199,41,0,
			202,0,42,205,0,0,208,40,40,211,39,0,214,0,40,217,0,0,220,
			37,37,223,32,0,226,0,37,229,0,0,232,247,247,235,37,0,238,
			0,247,241,0,0,244,11,11,247,0,0,250,0,11,253,0,0,256,6,
			37,259,12,12,262,4,0,265,0,12,268,0,0,271,11,12,274,0,12,
			292,291,291,280,11,0,283,0,291,286,0,0,289,0,0,292,6,40,
			295,40,0,298,310,310,301,311,311,304,0,310,307,0,311,310,0,
			0,313,37,1,316,323,323,319,0,323,322,1,0,325,0,0,328,1,1,
			331,37,37,334,11,0,337,0,37,340,0,0,343,0,0,232,11,11,349,
			38,0,352,0,11,355,0,0,358,373,373,361,42,0,364,0,373,367,
			0,0,370,38,38,373,0,0,376,0,38,379,0,0,382,42,0,385,397,
			397,388,398,398,391,0,397,394,0,398,397,0,0,400,11,1,403,
			410,410,406,0,410,409,1,0,412,0,0,415,1,1,418,0,0,232,7,
			42,424,42,0,427,439,439,430,440,440,433,0,439,436,0,440,439,
			0,0,442,38,1,445,452,452,448,0,452,451,1,0,454,0,0,457,1,
			1,460,0,0,232,7,42,466,42,0,469,481,481,472,482,482,475,0,
			481,478,0,482,481,0,0,484,38,1,487,494,494,490,0,494,493,1,
			0,496,0,0,499,1,1,502,517,517,505,40,0,508,0,517,511,0,0,
			514,38,38,517,0,0,520,0,38,523,0,0,526,7,40,529,0,0,232,6,
			40,535,40,0,538,550,550,541,551,551,544,0,550,547,0,551,550,
			0,0,553,38,1,556,563,563,559,0,563,562,1,0,565,0,0,568,1,
			1,571,586,586,574,42,0,577,0,586,580,0,0,583,38,38,586,0,
			0,589,0,38,592,0,0,595,6,42,598,0,0,232,616,616,604,38,0,
			607,0,616,610,0,0,613,38,38,616,0,0,619,0,38,622,0,0,625,
			0,0,232,643,643,631,42,0,634,0,643,637,0,0,640,11,11,643,
			0,0,646,0,11,649,0,0,652,38,0,655,667,667,658,668,668,661,
			0,667,664,0,668,667,0,0,670,11,1,673,680,680,676,0,680,679,
			1,0,682,0,0,685,1,1,688,6,42,691,0,0,571,38,-1,697,0,0,
			571,715,715,703,40,0,706,0,715,709,0,0,712,37,37,715,0,0,
			718,0,37,721,0,0,724,7,40,727,0,0,232,6,37,733,0,0,232,
			11,11,739,38,0,742,0,11,745,0,0,748,763,763,751,42,0,754,
			0,763,757,0,0,760,38,38,763,0,0,766,0,38,769,0,0,772,6,42,
			775,11,0,781,0,0,787,0,0,784,0,11,790,0,0,730,7,11,793,0,
			11,799,0,0,730,814,814,802,37,0,805,0,814,808,0,0,811,37,
			37,814,0,0,817,0,37,820,0,0,823,0,0,232,841,841,829,40,0,
			832,0,841,835,0,0,838,11,11,841,0,0,844,0,11,847,0,0,850,
			0,11,895,7,11,856,40,0,859,871,871,862,872,872,865,0,871,
			868,0,872,871,0,0,874,11,1,877,884,884,880,0,884,883,1,0,
			886,0,0,889,1,1,892,0,0,799,7,40,898,0,0,730,38,0,907,0,
			0,913,0,0,910,0,38,919,38,38,916,0,0,937,7,38,922,0,38,
			931,38,38,928,0,0,937,38,38,934,7,38,937,0,0,232,0,38,946,
			38,38,232,38,38,949,6,38,952,0,0,232,42,0,958,965,965,961,
			0,965,964,38,0,967,0,0,970,0,0,571,42,0,976,38,1,979,986,
			986,982,0,986,985,1,0,988,0,0,991,1,1,994,0,0,571,11,11,
			1000,8,0,1003,0,11,1006,0,0,1009,38,11,1012,1027,1027,1015,
			42,0,1018,0,1027,1021,0,0,1024,38,38,1027,0,0,1030,0,38,
			1033,0,0,1036,6,42,1039,12,12,1042,12,0,1045,0,12,1048,0,0,
			1051,38,0,1057,0,0,1060,0,0,1066,6,12,1063,0,0,1093,13,13,
			1069,38,0,1072,0,13,1075,0,0,1078,6,13,1081,13,0,1087,0,0,
			1090,0,0,1093,6,12,1093,38,0,1096,0,38,1099,0,0,1102,7,11,
			1105,0,11,1111,0,0,1042,38,38,1114,12,0,1117,0,38,1120,0,0,
			1123,0,0,232,11,11,1129,8,0,1132,0,11,1135,0,0,1138,12,12,
			1141,1156,1156,1144,42,0,1147,0,1156,1150,0,0,1153,14,14,1156,
			0,0,1159,0,14,1162,0,0,1165,6,42,1168,1183,1183,1171,42,0,
			1174,0,1183,1177,0,0,1180,15,15,1183,0,0,1186,0,15,1189,0,
			0,1192,6,42,1195,12,0,1198,0,12,1201,0,0,1204,38,0,1210,0,
			0,1213,0,0,1228,13,13,1216,15,0,1219,0,13,1222,0,0,1225,0,
			0,1270,13,13,1231,38,0,1234,0,13,1237,0,0,1240,6,13,1243,
			13,0,1249,0,0,1252,0,0,1258,0,0,1213,0,0,1270,13,13,1261,
			14,0,1264,0,13,1267,0,0,1270,13,0,1276,0,0,1279,0,0,1285,
			6,12,1282,0,0,1300,6,13,1288,13,0,1294,0,0,1297,0,0,1300,
			6,12,1300,38,0,1303,0,38,1306,0,0,1309,14,0,1312,0,14,1315,
			0,0,1318,15,0,1321,0,15,1324,0,0,1327,7,11,1330,0,11,1336,
			0,0,1195,38,38,1339,12,0,1342,0,38,1345,0,0,1348,0,0,232,
			1366,1366,1354,42,0,1357,0,1366,1360,0,0,1363,11,11,1366,0,
			0,1369,0,11,1372,0,0,1375,12,12,1378,6,12,1381,38,11,1384,
			11,0,1390,0,0,1393,0,0,1456,38,0,1396,0,11,1399,0,0,1402,
			7,12,1405,38,38,1408,12,0,1411,0,38,1414,0,0,1417,42,0,1420,
			1432,1432,1423,1433,1433,1426,0,1432,1429,0,1433,1432,0,0,1435,
			11,1,1438,1445,1445,1441,0,1445,1444,1,0,1447,0,0,1450,1,1,
			1453,0,0,232,0,0,1378,0,35,1465,0,0,232,1480,1480,1468,17,
			0,1471,0,1480,1474,0,0,1477,11,11,1480,0,0,1483,0,11,1486,
			0,0,1489,0,11,1825,6,34,1495,12,12,1498,17,0,1501,0,12,
			1504,0,0,1507,6,12,1510,12,0,1513,1525,1525,1516,1526,1526,
			1519,0,1525,1522,0,1526,1525,0,0,1528,37,1,1531,1538,1538,
			1534,0,1538,1537,1,0,1540,0,0,1543,1,1,1546,6,12,1549,12,
			0,1552,1564,1564,1555,1565,1565,1558,0,1564,1561,0,1565,1564,
			0,0,1567,38,1,1570,1577,1577,1573,0,1577,1576,1,0,1579,0,0,
			1582,1,1,1585,6,12,1588,12,0,1591,1603,1603,1594,1604,1604,
			1597,0,1603,1600,0,1604,1603,0,0,1606,40,1,1609,1616,1616,
			1612,0,1616,1615,1,0,1618,0,0,1621,1,1,1624,6,12,1627,12,
			0,1630,1642,1642,1633,1643,1643,1636,0,1642,1639,0,1643,1642,
			0,0,1645,42,1,1648,1655,1655,1651,0,1655,1654,1,0,1657,0,0,
			1660,1,1,1663,39,39,1666,11,0,1669,0,39,1672,0,0,1675,5,0,
			1678,0,39,1681,0,0,1684,41,41,1687,39,0,1690,0,41,1693,0,
			0,1696,5,0,1699,0,41,1702,0,0,1705,17,17,1708,11,0,1711,0,
			17,1714,0,0,1717,6,11,1720,1735,1735,1723,11,0,1726,0,1735,
			1729,0,0,1732,37,37,1735,0,0,1738,0,37,1741,0,0,1744,6,11,
			1747,1762,1762,1750,11,0,1753,0,1762,1756,0,0,1759,38,38,1762,
			0,0,1765,0,38,1768,0,0,1771,6,11,1774,1789,1789,1777,11,0,
			1780,0,1789,1783,0,0,1786,40,40,1789,0,0,1792,0,40,1795,0,
			0,1798,6,11,1801,1816,1816,1804,11,0,1807,0,1816,1810,0,0,
			1813,42,42,1816,0,0,1819,0,42,1822,0,0,1825,0,0,232,0,11009,
			973,700,3656,11521,955,700,3664,25091,25977,124,700,3672,25603,
			28789,421,700,3682,25604,28530,112,571,700,3692,29444,24951,112,
			346,700,3704,29190,26739,26217,116,997,700,0,23299,23872,601,
			700,3730,23299,23841,628,700,3716,12290,61,901,700,3740,27652,
			29029,48,940,700,3760,27907,30837,1126,700,3772,28677,30049,25971,
			1459,700,3750,12802,42,421,973,700,3782,10279,28515,29550,10612,
			463,601,700,3806,8962,48,1908,0,3822,8962,49,1908,1,3832,8963,
			12589,1908,-1,3842,8962,50,1908,2,3852,11525,25955,27756,1908,
			-2,3794,12546,43,1919,973,700,3874,12546,45,1919,955,700,3862,
			10246,30064,26739,41,463,421,601,346,1940,532,700,3898,10276,
			28789,41,463,421,601,1954,17,601,1900,973,346,1940,532,700,
			3922,10277,24950,10610,463,1900,700,3954,10278,29557,29285,41,
			463,601,1954,17,601,1900,973,700,3886,10561,700,3994,28420,
			25974,114,346,421,532,346,463,700,4000,26886,30318,29285,116,
			1924,346,955,700,4020,30723,29295,532,421,2015,346,463,1126,
			700,4038,28418,114,2004,1126,700,4058,24835,25710,1914,346,1126,
			700,4070,12802,47,1919,997,700,4084,16385,2045,601,700,4096,
			8449,2045,628,700,3968,16386,43,421,2050,700,4106,15364,27503,
			62,1989,20,4116,15366,28005,29801,62,1989,22,4140,15365,25963,
			15993,1989,24,4154,15366,25445,28520,62,1989,26,4166,15369,26988,
			25972,24946,15980,1989,28,4180,15365,24948,15984,1989,30,4196,
			15368,30821,25968,29795,62,1989,32,4208,15367,29285,28530,15986,
			1989,34,4224,15366,28515,25708,62,1954,64,700,4128,25351,29301,
			25970,29806,1954,54,700,4254,29192,28527,11636,28534,99,1954,
			60,700,4270,29700,26984,115,1965,0,700,4288,28675,25697,2148,
			1954,960,973,700,4302,8965,28534,29539,1908,8,4318,25351,28271,
			25972,29816,1954,38,700,4330,25091,27500,1981,0,4346,29443,29283,
			1981,47,4356,25092,29537,101,1989,36,4366,25603,27760,1989,38,
			4378,26627,25708,1989,40,4388,29445,24948,25972,1989,42,4398,
			15875,28265,1989,44,4410,29444,24944,110,1989,46,4420,25090,108,
			1908,32,4238,26626,63,1908,32,4442,25350,25465,25964,115,1908,
			68,4452,29442,112,1908,84,4466,29957,25971,16242,1908,72,4476,
			25355,27745,25193,24946,26996,28271,1981,5120,4488,29189,25697,
			30825,2187,2050,700,4432,26628,29285,101,2224,2050,700,4520,
			29443,16496,2236,2050,1940,700,4534,29443,8560,1946,1954,42,628,
			1919,571,700,4548,29219,16496,1954,40,601,1946,700,4568,29219,
			8560,463,346,1954,40,628,532,700,4584,26627,30821,1954,16,2187,
			2055,700,4604,25607,25445,28009,27745,1954,10,2187,2055,700,4620,
			23809,1924,2203,2055,700,4640,23361,1914,2203,2055,700,4652,28163,
			28777,346,571,700,4664,29700,25461,107,346,2004,700,4676,16132,
			30052,112,421,736,2353,421,700,4690,29218,64,463,463,2342,532,
			532,700,4708,29187,29807,532,346,463,346,700,4726,11524,28530,
			116,2366,2366,700,4742,12805,29284,28783,571,571,700,4756,12804,
			30052,112,2004,2004,700,4506,29444,25960,100,2366,571,700,4770,
			15617,955,901,700,4798,15362,62,2401,901,700,4808,12290,62,940,
			901,700,4820,12291,15932,901,901,700,4832,12291,15676,2413,901,
			700,4844,15361,2389,940,346,940,736,2461,736,2456,2389,1940,940,
			346,1940,940,736,2449,571,799,2454,736,2454,2382,1914,700,799,
			2459,2382,1924,700,799,2466,736,2466,2382,1914,700,2389,955,940,
			736,2482,346,1940,346,955,940,736,2480,1924,700,1914,700,2382,
			1914,700,4856,15873,346,2430,700,4970,12290,60,1914,2430,700,
			4980,12291,15678,2493,901,700,4992,15874,61,2430,901,700,5004,
			15362,61,2487,901,700,5016,29954,60,2389,2499,346,2499,2407,
			532,2430,463,2407,700,5028,29954,62,346,2517,700,5054,29955,
			15678,2517,901,700,5066,29955,15676,2530,901,700,5078,30470,
			29801,26984,110,2004,955,532,955,463,2517,700,5090,28166,26469,
			29793,101,1946,2015,700,5114,29443,25662,421,2493,700,5130,24835,
			29538,2568,736,2578,2562,700,5142,25348,27749,108,1908,2,5158,
			25349,27749,11116,2583,973,700,5170,25349,27749,29548,1900,700,
			5184,25349,27749,11628,2583,955,700,5196,25863,25976,30051,25972,
			2045,532,700,4784,16392,30821,25445,29813,101,2050,2610,700,5210,
			16165,30821,29801,736,2629,724,700,5244,27396,31077,63,1459,1924,
			601,2562,2568,736,2653,1954,6,2050,1954,8,2038,736,2650,124,
			571,1914,700,1924,700,5260,27395,31077,2081,2619,736,2658,700,
			5310,25860,26989,116,2075,2619,700,5326,25346,114,1954,13,2667,
			1954,10,2667,700,5340,26379,29797,25389,29301,25970,29806,2132,
			2050,700,5360,29451,29797,25389,29301,25970,29806,2132,2055,700,
			5226,27652,29537,116,2687,2050,700,5380,28676,25449,107,2270,
			973,601,700,5414,11010,33,2045,2342,601,973,346,628,700,5430,
			27654,26739,26217,116,2562,997,700,5450,25346,64,2061,346,1919,
			2038,736,2746,1954,8,997,700,1954,255,2038,700,5466,25346,33,
			346,1954,255,2038,421,1954,8,2730,2032,346,2342,2061,346,1919,
			2038,901,1954,255,2022,532,2004,2022,463,2038,2022,346,2055,700,
			5400,25347,11072,421,2736,700,5500,27907,30817,2389,2487,1126,
			700,5574,27907,28265,2389,2430,1126,700,5588,29449,30063,25458,
			11621,25705,1965,16,2050,700,5602,12802,33,2342,2055,2589,2055,
			700,5622,12802,64,421,2589,2050,346,2050,700,5638,12835,29246,
			463,346,532,346,532,532,700,5656,12835,15986,463,463,346,463,
			346,532,700,5562,29699,28789,1989,48,0,5676,29446,30063,25458,
			101,2851,2822,700,5708,24839,26988,28263,25701,421,1919,2038,2419,
			1919,2038,973,700,5724,24837,26988,28263,2264,2867,2224,2055,700,
			5750,24837,27756,29807,2224,2718,700,5768,11265,2879,2264,2055,
			2583,2888,700,5782,25346,44,2264,2753,1919,2888,700,5798,25349,
			30063,29806,421,1940,346,2736,700,5814,11015,29811,26994,26478,
			1919,2004,2797,2366,2004,973,2375,955,700,5832,29700,28793,101,
			421,736,2944,346,2911,2667,346,1946,799,2934,2382,700,5860,25349,
			28525,25974,1914,2790,532,799,2962,532,2784,2357,2753,1940,463,
			1940,826,2955,2382,700,5892,26116,27753,108,346,1914,2790,532,
			346,799,2980,2389,2753,1940,826,2977,2382,700,5932,25861,24946,
			25971,1914,2970,700,5696,25603,9327,2841,1900,421,2911,973,2867,
			2045,532,346,532,700,5982,10243,10532,2994,700,6010,11778,36,
			2994,2911,2934,700,5968,29445,24944,25955,2219,2667,700,6034,
			25349,29793,26723,2270,532,1965,10,2050,532,2287,1965,10,2055,
			2610,463,1965,10,2055,724,1914,700,6048,29701,29288,30575,2349,
			736,3066,1965,10,2050,2295,463,1965,10,2055,463,346,532,2277,
			463,700,6092,24837,28514,29810,1924,3050,700,6020,10247,25185,
			29295,10612,2994,346,736,3086,2911,2934,3071,571,700,6148,25605,
			28773,26740,1954,82,2050,2270,955,1946,700,6176,16134,25956,29808,
			104,3092,2505,1954,-4,2038,3050,700,6134,29955,11117,2389,973,
			532,2357,2499,532,2389,2038,2493,463,2032,532,2032,2493,463,
			2038,2562,463,346,700,6222,25607,25966,24935,25972,2015,532,
			2015,1919,3114,463,973,700,6268,25602,43,532,346,532,3114,463,
			973,463,973,700,6294,29955,10861,1914,346,1954,15,532,421,3114,
			2831,421,3114,463,973,463,736,3182,532,2004,3114,463,973,826,
			3167,2396,700,6318,10753,3162,571,700,6372,29958,12141,28525,
			100,2349,901,1954,-10,2038,3050,2389,2517,736,3244,2562,1954,
			15,532,532,421,3114,2831,421,3114,463,973,421,463,2357,346,
			532,3114,463,2419,346,2419,973,736,3237,532,571,1940,463,799,
			3238,571,463,826,3210,571,346,700,2382,571,1924,421,700,6382,
			27909,27951,25711,2568,421,532,736,3262,2562,532,3139,463,532,
			2568,736,3268,2357,973,463,3196,463,736,3276,346,2562,346,700,
			6498,12036,28525,100,2004,2493,346,3253,700,6554,27907,25711,3281,
			571,700,6572,12033,3281,2335,700,6198,10246,28005,29801,41,1459,
			694,700,6584,25860,26723,111,2088,2619,700,6594,29699,28769,421,
			3309,2004,2753,1940,700,6624,27396,24948,112,421,421,1954,13,
			2407,532,1954,10,2407,463,2038,736,3370,421,1954,8,2407,532,
			1954,127,2407,463,2038,736,3353,2219,3315,700,532,2004,2357,
			2430,421,736,3367,1954,8,421,3309,2219,3309,3309,463,973,700,
			571,2335,421,700,6610,24838,25443,28773,116,2004,973,2004,2389,
			2407,736,3402,2658,421,2219,955,1954,95,2517,736,3398,3315,
			799,3400,2102,2619,799,3382,571,2004,955,700,6748,25862,28792,
			25445,116,2110,2619,2214,2055,571,700,6812,29699,25193,2859,571,
			700,6834,28933,25973,31090,3420,1954,256,2110,2619,2851,2055,
			571,1914,2208,2055,700,6846,11529,29300,26977,26988,26478,532,
			799,3459,2219,2004,2357,973,2736,2430,736,3459,463,1940,700,
			826,3448,1914,700,6642,27652,28527,107,346,532,2375,421,736,
			3492,2004,2736,2357,955,2357,2219,2401,1954,4,2711,2610,736,
			3489,724,2396,700,2921,799,3470,724,2396,700,6926,29959,28014,
			29793,26723,736,3504,2413,700,2419,700,6990,27909,29793,26723,
			3500,2015,700,6878,28677,29281,25971,532,3420,2208,2050,973,
			2851,2050,2208,2050,955,2357,532,2004,463,346,2831,2357,1954,
			7000,3467,2389,463,1954,7020,3467,346,463,955,532,955,463,1940,
			2208,2718,463,2219,2401,736,3557,3445,1914,2790,700,7012,25094,
			28257,25966,114,532,421,2413,736,3575,2357,2667,1946,799,3566,
			571,724,700,7026,26628,27759,100,1924,2197,2718,2197,2050,2753,
			700,7156,8962,62,2382,2197,2050,2148,1954,896,973,2004,955,700,
			7120,25863,29816,24946,29795,421,532,3196,463,346,532,3196,463,
			2366,700,7204,25605,26473,29801,1954,9,2004,2430,1954,7,2038,
			973,1954,48,973,700,7178,8961,1929,3104,1914,2257,3607,3621,3582,
			700,7266,8962,115,3635,2389,2032,901,736,3646,700,7286,15362,35,
			2148,1954,896,973,2197,2055,700,7306,29444,26473,110,2499,2626,
			1954,45,3582,700,7326,29955,29230,532,1914,3656,3646,3592,463,
			2004,955,2219,3565,2934,700,7346,29954,46,3021,1914,3676,700,
			7234,10243,10542,2574,2257,1351,2349,736,3705,3698,3621,2667,700,
			7376,11777,3021,2568,736,3717,1954,45,2667,3698,700,7416,15879,
			30062,25197,29285,421,901,2626,2389,2831,571,2736,2257,532,1954,
			48,955,1954,9,2004,2430,736,3750,1954,7,955,421,1954,10,2430,
			2032,421,463,2517,901,736,3759,571,2841,700,346,2257,3162,571,
			2366,2257,3162,3150,2841,2921,421,901,736,3727,700,7438,28167,
			28021,25954,16242,1924,2192,2055,2257,532,2004,2736,1954,45,2401,
			421,532,736,3794,2921,2004,2736,1954,36,2401,736,3803,2305,2921,
			2831,1914,421,2841,3724,421,736,3835,2004,2736,1954,46,2407,
			736,3827,2396,2366,463,2382,1914,463,2187,2055,700,1946,2192,
			2055,1940,2192,2050,799,3807,2382,463,736,3840,3139,463,2187,
			2055,1924,700,7548,11778,115,3092,532,799,3855,2357,2711,3710,
			826,3852,700,7690,25351,28015,24944,25970,2366,2004,955,2349,
			736,3874,532,2382,463,2335,700,532,799,3889,2911,2366,2911,
			2366,955,2349,736,3889,724,2335,2335,700,826,3877,2382,1914,
			700,7716,28163,24934,2589,700,7788,25347,24934,3897,2784,1954,
			31,2038,973,2589,1935,2038,700,7390,10248,25971,29281,26723,41,
			346,532,421,421,736,3953,421,3897,2911,1954,159,2038,2357,2911,
			3863,901,736,3949,724,421,3897,1954,64,346,2050,2038,2419,1919,
			2032,2562,700,2335,2061,799,3921,724,2382,1914,700,7824,10246,
			26982,25710,41,532,2170,2061,736,3983,2061,2050,2357,346,3918,
			2349,736,3980,532,2396,463,724,700,2589,799,3964,571,1914,463,
			1914,700,7798,29455,24933,25458,11624,28535,25714,26988,29811,3918,
			2396,700,7976,26116,28265,100,3962,2396,700,8000,25383,28015,26992,
			25964,463,421,601,2893,1940,532,700,7914,10249,26988,25972,24946,
			10604,2203,2050,736,4032,4012,1954,2893,700,8014,27719,29801,
			29285,27745,2096,2619,700,8066,25352,28015,26992,25964,44,2045,
			2893,700,8038,16134,28518,28277,100,2626,3021,2911,2934,1954,63,
			2667,2673,1954,-13,3050,700,8082,26889,29806,29285,29296,29797,
			4004,2349,736,4105,2203,2050,736,4090,2413,736,4087,3902,2610,
			700,3902,4047,700,571,421,3897,2736,1954,32,2038,2419,1954,-14,
			2038,3050,3902,2610,700,421,532,2911,3779,736,4128,724,2192,
			2050,2493,736,4120,571,799,4126,2203,2050,736,4125,346,4038,
			4038,700,463,1914,4055,700,8134,26377,29797,28461,25714,29285,
			2170,1914,532,2061,2357,2022,736,4149,2589,799,4141,724,421,
			2602,346,2170,955,2045,421,532,1946,2568,1954,-50,2038,3050,
			532,799,4170,2061,346,2602,826,4167,2050,463,700,0,29449,29797,
			28461,25714,29285,421,1924,2401,736,4191,571,2141,1919,4181,700,
			421,2163,2487,1954,-49,2038,3050,2170,346,532,799,4206,2342,
			2055,2589,826,4203,1914,346,2055,700,8264,10247,29295,25956,
			10610,421,736,4234,1946,346,532,4217,2004,2357,2022,736,4233,
			1940,463,2375,700,724,700,8424,11526,29295,25956,114,4138,4217,
			2335,4181,700,8470,11014,29295,25956,114,421,532,4240,4138,463,
			346,1940,4181,700,8350,26126,29295,26740,30509,29295,27748,29545,
			116,1908,56,8518,29446,29561,25972,109,1908,62,8540,26117,29295,
			26740,2141,4268,1929,4181,700,8554,28420,27758,121,1924,4181,
			700,8100,11779,25705,3897,2911,1954,31,2038,2934,3021,700,8572,
			30469,29295,29540,2673,4138,2349,736,4335,346,2050,2349,736,4332,
			421,3897,2736,1954,128,2038,901,736,4329,421,4296,2050,799,4315,
			1946,799,4310,700,8490,25611,26213,28265,29801,28521,29550,2170,
			2050,2697,700,8672,30468,29295,100,1919,3104,3517,2264,2867,421,
			532,2389,2055,1940,346,2950,463,700,8586,29701,27503,28261,2219,
			4351,700,8730,16135,28277,29033,25973,421,2687,3918,901,2626,
			3021,2382,1954,66,2050,4296,3013,29193,25701,26213,28265,25701,
			2673,700,8744,16132,30062,108,2784,2626,1954,-16,3050,700,8792,
			16132,25964,110,2784,1954,31,2487,1954,-19,2038,3050,700,8694,
			25348,24936,114,4369,4400,2911,571,2736,700,8838,23366,26723,
			29281,93,4423,4012,1954,2893,700,8858,15201,1954,-13570,2407,
			1954,-22,2038,3050,1954,700,2893,2328,2349,736,4457,2687,2055,
			700,8878,14849,2879,2264,421,1954,66,2055,2704,2893,4369,4400,
			4410,4377,2911,973,2224,2055,2879,1954,-13570,2322,700,8916,
			14855,28526,24942,25965,2879,2264,1914,1954,-13570,2322,700,8962,
			10049,4369,4004,4055,3902,4038,700,8986,29287,25445,29301,25971,
			1954,66,2050,3902,4047,700,8812,29702,26479,27751,101,2342,2050,
			2022,346,2055,700,9024,26628,25705,101,4369,4004,4055,3897,1954,
			128,346,4517,700,9046,27940,29281,107,2264,1914,2893,700,9002,
			25189,26469,28265,2264,700,9088,26978,102,1954,736,2893,4540,
			700,9100,30053,29806,27753,2045,4553,2055,700,9116,24933,24935,
			28265,1954,799,2893,4047,700,9132,29796,25960,110,2264,2045,346,
			2055,700,9150,30565,26984,25964,4553,700,9168,29286,28773,24933,
			116,346,4570,4579,700,9180,25956,29548,101,1954,799,2893,4540,
			346,4579,700,9198,26211,29295,1954,532,2893,2264,700,9220,24931,
			29798,571,1954,799,2893,4540,2264,346,700,9236,28260,30821,116,
			1954,826,2893,4047,700,9072,10280,24941,27506,29285,41,463,1900,
			2061,2224,2055,2589,2050,2687,2055,700,9258,25350,25970,29793,
			101,2203,2050,532,4460,571,463,2203,2055,4012,1981,2687,2055,
			700,9308,30216,29281,24937,27746,101,4659,1914,2893,700,9344,
			25352,28271,29811,28257,116,4659,1935,2888,4012,1908,2893,700,
			9364,29956,25971,114,4659,1935,2888,4012,1989,2583,2242,2718,
			2242,2050,2893,700,9390,15877,28514,31076,2589,700,9276,10278,
			28516,29541,41,2841,1900,346,532,700,9434,10278,28515,28781,41,
			463,1954,66,2050,3902,2061,1954,1981,2407,1954,-31,2038,3050,
			2055,700,9422,25701,25967,15987,4012,4732,4012,4722,700,9494,
			27910,29281,25963,114,2704,2879,2264,4659,1935,2888,4012,4644,
			2893,2893,700,9512,15970,114,4012,532,700,9544,29282,62,4012,
			463,700,9556,29285,29284,28783,4012,724,700,9568,25956,27000,
			116,4012,700,700,9454,10243,10611,2879,1954,34,4351,2911,2335,
			1940,2888,2879,700,9582,11874,34,4012,3013,4801,700,9622,9314,
			34,4012,3008,4801,700,9636,24934,28514,29810,34,4012,3079,4801,
			700,9650,10305,1954,41,3517,2382,700,9668,11842,40,1954,41,3517,
			2934,700,9682,23617,3420,2050,2208,2055,700,9698,28744,29551,
			28788,28271,101,4369,4004,4055,3902,4047,700,9596,10245,26222,
			10593,2704,3897,4517,700,9712,26889,28013,25701,24937,25972,1954,
			64,4872,700,9752,25356,28015,26992,25964,28461,27758,121,1954,
			32,4872,700,9772,29443,25957,4369,4004,4055,2673,2061,1954,700,
			2407,736,4923,2061,3710,2589,2264,2004,2430,736,4921,571,700,
			799,4905,2050,3691,700,9796,25604,28021,112,2867,2349,736,4942,
			346,2061,3710,2589,346,2602,799,4931,571,700,9736,25349,29547,
			28021,2867,421,1954,-16162,955,532,2349,736,4967,346,2061,463,
			973,532,2589,346,2602,799,4954,571,463,700,9852,25607,26213,
			28265,25701,4369,4004,2335,2419,700,9940,23366,26740,28261,93,700,
			9960,23366,27749,25971,93,4369,2784,736,5010,4004,571,3902,421,
			1954,9982,2401,346,1954,9970,2401,2032,2626,799,4991,3427,571,
			799,4991,700,9972,23364,26217,93,2626,4991,700,10030,27906,115,
			532,1459,2251,2050,532,826,5030,826,5026,700,10044,25092,27749,
			108,1954,7,2667,700,9888,25347,26995,1954,27,2667,1954,91,2667,
			700,10070,28676,26465,101,5046,3013,12802,74,5046,3013,12548,
			12603,72,700,10106,24837,11636,31096,2257,2315,532,5046,1914,
			3676,3013,15105,1914,3676,3013,18433,463,2187,2055,700,10134,
			25093,25135,26229,1908,1024,10086,15367,27746,25455,15979,1981,
			10276,10186,25092,26229,48,1908,-3072,10200,25606,29289,31092,
			48,1981,0,10212,25092,27500,48,1981,-1,10226,15877,25697,29284,
			421,1919,2038,2419,1954,-9,2038,3050,2045,700,10238,10247,27746,
			25455,10603,1459,532,5123,346,5123,346,463,5123,532,799,5157,
			2389,601,346,628,1940,346,1940,346,826,5149,2382,700,10266,
			30214,27745,25705,63,421,1919,1954,128,2550,700,10322,29704,
			24946,29550,25958,114,5098,2050,2610,700,10344,15876,27746,107,
			1946,5091,3188,700,10364,25349,25964,28257,1914,5111,2055,700,
			10380,26890,30318,27745,25705,29793,101,1924,5117,2055,700,10396,
			25092,30064,116,5166,736,5221,5186,5104,5091,5178,700,571,700,
			10418,25092,25959,116,5166,736,5236,5186,5104,346,5091,5178,
			700,571,700,10446,27655,24943,25956,16228,421,5117,2050,2401,
			700,10174,29958,25712,29793,101,1924,5111,2055,700,10496,29452,
			30305,11621,30050,26214,29285,115,5111,2050,736,5273,5117,2050,
			5213,5194,700,10514,26117,30060,26739,5265,5205,700,10548,25869,
			28781,31092,25133,26229,25958,29554,5194,5205,700,10562,25094,
			26229,25958,114,1919,3104,5166,901,1954,-35,2038,3050,5243,736,
			5311,571,5104,700,5265,5117,2055,5104,700,10584,25093,28524,
			27491,5243,736,5326,571,5104,700,421,5297,346,5227,700,10476,
			11781,28005,29801,421,2219,1954,127,2550,901,736,5346,571,1954,
			46,2667,700,10632,25093,24940,27502,2219,2970,700,10696,27652,
			29545,116,5057,2673,421,532,5320,1954,15,532,1954,15,2357,955,
			1954,3,3676,3021,1954,63,532,2911,5335,826,5378,2673,826,5367,
			571,463,2181,2055,700,10710,26377,29797,26925,28782,29813,2859,
			2208,2050,2807,2068,2050,700,10780,29449,29797,26925,28782,29813,
			2068,2055,1965,16,2055,2208,2055,2851,2814,700,10662,28418,107,
			2203,2050,2626,3013,8195,27503,2673,700,10838,25860,24950,108,
			4369,2784,736,5443,4073,1914,3104,799,5434,571,2068,2619,700,
			10806,25864,24950,30060,29793,101,5396,2831,2831,532,1914,1924,
			1954,3998,5409,1954,10868,3028,463,2841,2841,5409,3050,700,10860,
			27652,28265,101,1954,6,2730,346,5320,973,1954,64,700,10942,27656,
			24943,27748,28265,101,5475,5453,700,10894,27652,24943,100,2176,
			2050,532,421,2176,2055,1914,1954,15,532,2389,2831,5490,2841,
			1940,826,5507,2382,463,2176,2055,700,8608,25862,28518,29810,104,
			1908,265,10968,26884,26222,111,2673,3013,25883,28486,29810,8296,
			12662,14638,8236,30032,27746,25449,17440,28015,26977,11374,2264,
			3710,2673,3013,21033,25449,24936,25714,18976,28001,29541,18464,
			30575,11365,26656,30575,11877,11890,11882,14648,26432,24941,27753,
			25390,28015,2673,3013,26656,29812,29552,12090,26415,29801,30056,
			11874,28515,12141,28520,25975,27250,29487,25205,25964,113,2673,
			700,11052,30723,28521,1954,6758,2110,2055,2102,2055,2088,2055,
			2068,2055,700,11184,26628,28257,100,1954,10844,1954,6604,1954,
			6,2050,1919,2038,736,5624,571,1954,3700,1954,6650,2328,5595,
			700,11212,28676,25441,101,1954,11,2667,700,11258,26116,27753,
			101,1954,11266,1954,3700,1954,6650,5595,700,11274,25351,28271,
			28531,25964,1954,5268,2081,2055,1954,6604,2075,2055,5610,700,
			11298,26883,8559,5654,700,11328,29705,29537,11627,28265,29801,
			1954,34,2050,346,1954,34,2055,2148,2045,1965,0,2055,1954,3678,
			2045,1965,2,2055,2148,1954,256,973,2045,1965,6,2055,2148,1954,
			512,973,2045,1965,8,2055,1914,1965,4,2055,2315,5667,1954,8050,
			2096,2055,1954,3678,2117,2055,1914,2208,2055,1924,2192,2055,
			2148,1954,512,973,1914,2851,2814,1954,34,2055,700,11338,26883,
			26990,1954,34,2050,5675,700,11480,10247,29285,28530,10610,421,
			3021,3710,1954,63,2667,2673,1924,2401,736,5765,124,5743,1954,
			11506,2117,2055,700,10986,28932,26997,116,1954,11506,2117,2055,
			3427,1954,10868,3028,2349,736,5788,2117,2619,799,5779,700,11496,
			10246,28515,25708,41,4281,4343,5743,1954,6,2050,1954,4,2038,736,
			5808,5530,1954,6,2050,1929,2038,736,5845,1954,8,2050,1900,421,
			2264,346,955,4948,1954,36,2050,2407,736,5837,3013,25097,25697,
			25376,29547,28021,124,1954,6,2050,1929,2022,1954,6,2055,5775,
			700,11582,29701,29537,14955,4659,2264,5091,2888,2045,5675,700,
			11694,24840,29795,30313,29793,101,421,5675,421,532,346,2045,346,
			1954,2,973,2055,463,2148,2050,532,421,2045,2148,2055,463,346,
			2055,700,11716,30468,26977,116,1459,2061,736,5891,1914,346,2055,
			700,11774,29446,26473,24942,108,2148,346,2055,700,11798,29446,
			28265,27751,101,1919,1954,70,2055,700,11816,27909,27765,26996,
			1914,1954,70,2055,700,11836,29444,28261,100,2148,2004,1954,12,
			973,1459,2061,901,736,5936,2055,1954,14,973,2055,700,11854,
			29191,25445,26981,25974,1459,1965,12,2050,736,5952,1965,14,2050,
			1965,12,2050,1914,1965,12,2055,700,11542,25862,26980,28532,114,
			1954,58,4250,700,0,28929,1954,58,4240,700,11956,16129,2181,
			2050,3710,700,11968,27649,2181,2050,5359,700,11980,30721,5980,
			2181,2050,5497,5974,700,11992,26882,97,1929,3104,1954,6,2730,
			973,2181,2050,5320,973,3420,2208,2050,973,346,2859,2335,2208,
			2050,955,2950,3420,2050,2208,2055,5992,700,12008,24833,1914,
			346,6007,700,12068,30465,4138,1954,58,1919,4181,4308,4181,700,
			12080,29441,5253,5278,700,12100,28161,1919,2181,2718,5992,700,
			12110,28673,1924,2181,2718,5992,700,12124,29185,2181,2055,5992,
			700,12138,31233,2181,2050,5320,5091,5352,5992,700,12150,25601,
			1919,3104,532,2181,2050,5320,463,1954,6,2730,973,1954,64,5352,
			5992,700,11938,25348,27759,100,1954,64,1900,2619,700,
		];

		function updateDump() {
			function dump(a, as, base) {
				function isgraph(u) { return u >= 32 && u < 127; }
				function char(u) { return isgraph(u) ? String.fromCharCode(u) : "."; }
				function chars(u) { return char(u & 255) + char((u >> 8) & 255); }
				function maxPad(max, base) { return Math.ceil(Math.log(max) / Math.log(base)); }
				function pad(number, length) {
					var str = "" + number;
					while (str.length < length) str = "0" + str;
					return str;
				}
				var r = "", p = maxPad(65536, base), cols = 12 - p;
				for (let i = 0; i < as; i += cols) {
					var l = pad(i.toString(base), p) + ": ";
					for (let j = 0; j < cols && (i + j) < as; j++) {
						l += pad(m[i+j].toString(base), p) + " ";
					}
					l += "\t|";
					for (let j = 0; j < cols && (i + j) < as; j++) {
						l += chars(m[i+j]);
					}
					r += l + "|\n";
				}
				return r;
			}
			let base = document.getElementById("base").value;
			base = base > 36 || base < 2 ? 16 : base;
			document.getElementById("dump").innerHTML = dump(m, 65536, base);
		}

		function downloadTextAsFile(filename, text) {
			var e = document.createElement("a");
			e.setAttribute("href", "data:text/plain;charset=utf-8," + encodeURIComponent(text));
			e.setAttribute("download", filename);
			e.style.display = "none";
			document.body.appendChild(e);
			e.click();
			document.body.removeChild(e);
		}

		function openTab(evt, name) {
			let tabcontent = document.getElementsByClassName("tabcontent");
			for (let i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = "none"; }
			let tablinks = document.getElementsByClassName("tablinks");
			for (let i = 0; i < tablinks.length; i++) { tablinks[i].className = tablinks[i].className.replace(" active", ""); }
			document.getElementById(name).style.display = "block";
			evt.currentTarget.className += " active";
			focused = false;
			switch (name) {
			case "subleq": queueDraw(); focused = true; break;
			case "image": updateDump(); break;
			case "settings": setValuesFromStorage(); break;
			}
		}

		function bringUpKeyboardOnMobile() {
			let input = document.createElement("input");
			const name = "fakeTextField" + Math.random();
			input.type = "text";
			input.id = name;
			document.body.appendChild(input);
			document.getElementById(name).focus();
			document.getElementById(name).style.display = "none";
		}

		function saveImage() {
			function isNumeric(str) {
				if (typeof str != "string") return false;
				return !isNaN(str) && !isNaN(parseFloat(str));
			}
			function save(filename, data) {
				var blob = new Blob([data], {type: "text/plain"});
				if (window.navigator.msSaveOrOpenBlob) {
					window.navigator.msSaveBlob(blob, filename);
					return;
				}
				var elem = window.document.createElement("a");
				elem.href = window.URL.createObjectURL(blob);
				elem.download = filename;
				document.body.appendChild(elem);
				elem.click();
				document.body.removeChild(elem);
			}
			let filename = document.getElementById("fname").value;
			let cells = document.getElementById("cells").value;
			filename = filename == undefined || filename === "" ? "subleq.dec" : filename;
			cells = isNumeric(cells) ? parseInt(cells) : 8192;
			if (cells < 0)
				cells = 0;
			if (cells > 65536)
				cells = 65536;
			let x = "";
			for (let i = 0; i < cells; i++)
				x += m[i].toString() + "\n"; /* NB. Could use saved base here */
			if (document.getElementById("optimizeImage").checked) /* WTF? This is very brittle, why did I decide this was a good thing... */
				x = x.replace(/(0\n)+$/g, "");
			save(filename, x);
		}

		function loadImageFromArray(a) {
			for (var i = 0; i < 65536; i++)
				m[i] = undefined == a[i] ? 0 : a[i];
			loaded = true;
		}

		function loadImage() {
			function loadImageFromString(str) {
				var txt = str.split(/\r?\n/g);
				for (var i = 0; i < 65536; i++)
					m[i] = undefined == txt[i] ? 0 : parseInt(txt[i]);
				loaded = true;
			}
			document.getElementById("input").files[0].text().then(t =>{ loadImageFromString(t); updateDump();});
			pc = 0;
			display = "";
			input = init;
		}

		function saveState() {
			function setVal(cname, cvalue) { return localStorage.setItem(cname, cvalue); }
			setVal("highlight",     document.getElementById("highlight").checked);
			setVal("scroll",        document.getElementById("scroll").checked);
			setVal("optimizeImage", document.getElementById("optimizeImage").checked);
			setVal("hideAlert",     document.getElementById("hideAlert").checked);
			setVal("base",          document.getElementById("base").value);
		}

		function setValuesFromStorage() {
			function getVal(cname, defaultVal) {
				let val = localStorage.getItem(cname);
				if (val !== null) { return val; }
				return defaultVal;
			}
			function toBool(val) { return val === "true" ? true : false; }
			document.getElementById("highlight").checked     = toBool(getVal("highlight", "true"));
			document.getElementById("scroll").checked        = toBool(getVal("scroll", "true"));
			document.getElementById("optimizeImage").checked = toBool(getVal("optimizeImage", "true"));
			document.getElementById("hideAlert").checked     = toBool(getVal("hideAlert", "false"));
			document.getElementById("base").value            = getVal("base", 16);
		}

		function unesc(i) {
			i = i.replace(/&amp;/g, "&");
			i = i.replace(/&lt;/g, "<");
			return i.replace(/&gt;/g, ">");
		}

		function esc(i) {
			i = i.replace(/&/g, "&amp;");
			i = i.replace(/</g, "&lt;");
			return i.replace(/>/g, "&gt;");
		}

		function highlight(i) { /* good enough, could also <u> things */
			if (!document.getElementById("highlight").checked)
				return i;
			i = i.replace(/\b[0-9]+[^a-zA-Z=<>*\(\)\/@+&-]/g, function(x) { return "<b>" + x + "</b>"; });
			return i.replace(/\b(if|else|for|next|aft|then|while|begin|repeat|until|again)\b/g, function(x) { return "<i>" + x + "</i>"; });
		}

		function doDraw() {
			document.getElementById("subleq").innerHTML = "<pre>" + highlight(esc(display)) + cursor + "</pre>";
			if (document.getElementById("scroll").checked)
				window.scrollTo(0, document.body.scrollHeight);
		}

		function queueDraw() { /* might be better with two timers, so redraw is done at least every X ms */
			if (redrawTimeout) { /* expensive operation, do not redraw every key-press */
				clearTimeout(redrawTimeout);
				redrawTimeout = null;
			}
			redrawTimeout = setTimeout(doDraw, 50);
		}

		function backspace() {
			let last = display.slice(-1);
			if (last != "\n" && last != "\r")
				display = display.substring(0, display.length - 1);
		}

		function keyToKey(k) { /* NB. Fun to funky */
			switch (k) {
			case "Enter": return "\n";
			case "Escape": return "\u001B";
			case "Delete": case "Backspace": return "\u0008";
			default: if (k.length != 1) k = ""; return k;
			}
		}

		document.documentElement.addEventListener("keydown", function (e) {
			if (!focused) return false;
			var k = keyToKey(e.key);
			if (k.length === 0) { return false; }
			else if (k === "\u0008") { backspace(); }
			else if (k === "\u001B") { running = false; return false; }
			else { display += k; }
			input += k;
			queueDraw();
			return false;
		}, false);

		const alert = document.querySelector('.alert');

		alert.style.display = "block";
		if (localStorage.getItem('hideAlert') === "true") { alert.style.display = "none"; }

		const dismissAlertButton = document.querySelector('.alert button');
		if (dismissAlertButton) {
			dismissAlertButton.addEventListener('click', event => {
				event.preventDefault();
				alert.classList.add('alert-hidden');
				localStorage.setItem("hideAlert", true);
			})
		} 

		function getch() {
			if (input.length === 0)
				return -1;
			let r = input.charCodeAt(0);
			input = input.substring(1);
			return r;
		}

		function ansiEscapeCodes(disp) { /* super lazy, needed for "page"  */
			let nd = disp.replace(/\u001B\[2J/,"");
			if (disp != nd) { return ""; }
			return disp.replace(/\u001B\[[0-9]*;?[0-9]*H/, ""); /* cursor position not implemented */
		}

		function setbg(color) { document.body.style.backgroundColor = color; }

		function bell() {
			let ms = 500, on = "gray", off = "white";
			setbg(on);
			setTimeout(function () { setbg(off); }, ms * 1);
			setTimeout(function () { setbg(on);  }, ms * 2);
			setTimeout(function () { setbg(off); }, ms * 3);
		}

		function putch(ch) {
			let o = String.fromCharCode(ch);
			if (o === "\u0008") { backspace(); }
			else if (o === "\u0007") { bell(); }
			else { display = ansiEscapeCodes(display + o); }
			queueDraw();
		}

		function subleq() { /* The ISA of the future! */
			if (!loaded) { setTimeout(subleq, 10); return; }
			while ((pc & 0x8000) === 0 && running) {
				if (cycles++ > 1000000 || !focused) { cycles = 0; setTimeout(subleq, 1); return; }
				let a = m[pc+0];
				let b = m[pc+1];
				let c = m[pc+2];
				if (a === 0xFFFF) {
					let ch = getch();
					if (ch < 0) {
						setTimeout(subleq, 10);
						return;
					}
					m[b] = ch;
					pc += 3;
				} else if (b === 0xFFFF) {
					putch(m[a]);
					pc += 3;
				} else {
					let d = m[b] - m[a];
					m[b] = d;
					pc = (d & 0x8000) || (d === 0) ? c : pc + 3;
				}
				pc &= 0xFFFF;
				total++;
			}
			if (reloadOnExit)
				window.location.reload();
		}
		document.getElementsByClassName("tablinks")[0].click();
		bringUpKeyboardOnMobile();
		setValuesFromStorage();
		console.log("subleq running...");
		loadImageFromArray(eForth);
		queueDraw();
		subleq();
	</script>
</body>
</html>
